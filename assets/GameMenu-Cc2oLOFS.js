import{r as d,i as oe,j as e,f as le,u as E}from"./vendor-Cc93p67d.js";import{o as de,S as ce}from"./game-content-BqNkj8Jh.js";import{bh as ue,bi as me,bj as ge,bk as xe,bl as he,ar as q,bm as fe,aw as pe,bn as be,u as ye,bo as J}from"./game-core-BhyilOjL.js";import{E as T}from"./EnhancedButton-DVdhyrz_.js";import{g as ve}from"./index-B91FtUQv.js";import"./phaser-DkaA9Y8j.js";const je="2026.1.0",re={version:je},we=/^(\d{4})\.(\d+)\.(\d+)$/,Q=re.version.match(we),ke=new Date().getFullYear(),Le=re.version,Se=Q?Number(Q[1]):ke,B=8,Z=8,ee=120,g={borderDefault:"rgba(56,189,248,0.24)",borderActive:"rgba(99,102,241,0.7)",borderHover:"rgba(56,189,248,0.45)",background:"linear-gradient(140deg, rgba(10,17,30,0.96), rgba(11,25,46,0.86))",backgroundPressed:"linear-gradient(140deg, rgba(17,28,49,0.98), rgba(15,34,58,0.92))",listBackground:"rgba(9,15,26,0.98)",shadowRest:"0 14px 28px rgba(8,13,23,0.52)",shadowActive:"0 18px 36px rgba(14,30,52,0.58)",textPrimary:"#f0f6ff",textSubtle:"#8da2c0",textMuted:"#6b7a94"},ae={hud:{width:"100%",triggerPadding:"0.65rem 0.85rem",triggerFontSize:"0.85rem",optionFontSize:"0.85rem",summaryFontSize:"0.7rem",optionPadding:"0.55rem 0.7rem",maxListHeight:220},menu:{width:"min(320px, 100%)",triggerPadding:"0.75rem 1rem",triggerFontSize:"0.92rem",optionFontSize:"0.92rem",summaryFontSize:"0.72rem",optionPadding:"0.6rem 0.85rem",maxListHeight:260}},Ne={position:"absolute",top:"50%",right:"0.9rem",transform:"translateY(-50%)",pointerEvents:"none",fontSize:"0.8rem",transition:"transform 0.18s ease",color:g.textSubtle},Ee=({config:l,isHighlighted:n,isSelected:m,hasSummary:w})=>({width:"100%",display:"flex",flexDirection:"column",alignItems:"flex-start",gap:w?"0.25rem":0,border:"none",borderRadius:"9px",padding:l.optionPadding,background:m||n?"linear-gradient(135deg, rgba(56,189,248,0.22), rgba(59,130,246,0.18))":"transparent",color:g.textPrimary,cursor:"pointer",textAlign:"left",transition:"background 0.15s ease, color 0.15s ease, transform 0.12s ease",transform:n?"translateX(4px)":"translateX(0)"}),Me=l=>({fontSize:l.summaryFontSize,lineHeight:1.4,color:g.textMuted}),He=(l,n)=>{const m=ae.menu===n?44:40;return l.summary?m+22:m},Ce=(l,n,m)=>{const c=l.reduce((k,b)=>k+He(b,n),0)+(m?20:16);return m?Math.min(n.maxListHeight,c):c},te=({value:l,options:n,onChange:m,variant:w="hud",fullWidth:O=!1,dataFocusIgnore:c=!1,triggerId:k,triggerTestId:b})=>{var V;const L=`${d.useId()}-autobattle-profiles`,u=ae[w],R=d.useRef(null),a=d.useRef(null),x=d.useRef(null),[s,y]=d.useState(!1),[v,M]=d.useState(()=>Math.max(n.findIndex(r=>r.id===l),0)),[o,H]=d.useState(null),_=n.length>4,W=d.useMemo(()=>Ce(n,u,_),[n,u,_]),f=d.useCallback((r=!1)=>{var X;if(!s||!a.current||typeof window>"u"||typeof document>"u")return;const i=a.current.getBoundingClientRect(),h=r?(X=x.current)==null?void 0:X.getBoundingClientRect().height:void 0,N=Math.max(ee,Math.min(u.maxListHeight,h??W)),p=Math.max(0,window.innerHeight-i.bottom-B),z=Math.max(0,i.top-B),G=p>=N||p>=z?"down":"up",ne=Math.max(ee,G==="down"?p:z),Y=Math.min(u.maxListHeight,ne),U=Math.min(N,Y),se=G==="down"?Math.min(window.innerHeight-B-U,i.bottom+Z):Math.max(B,i.top-U-Z),K=Math.max(i.width,180),ie=Math.max(B,Math.min(i.left,window.innerWidth-K-B));H({left:ie,top:se,width:K,maxHeight:Y,direction:G})},[u.maxListHeight,W,s]);d.useEffect(()=>{if(!s)return;const r=i=>{var N,p;const h=i.target;h&&((N=R.current)!=null&&N.contains(h)||(p=x.current)!=null&&p.contains(h)||y(!1))};return document.addEventListener("pointerdown",r),()=>{document.removeEventListener("pointerdown",r)}},[s]),d.useEffect(()=>{if(!s){H(null);return}f(!1);const r=()=>{f(!0)};return window.addEventListener("resize",r),window.addEventListener("scroll",r,!0),()=>{window.removeEventListener("resize",r),window.removeEventListener("scroll",r,!0)}},[s,f]),d.useEffect(()=>{if(!s){M(Math.max(n.findIndex(r=>r.id===l),0));return}f(!0)},[s,n,l,f]),d.useEffect(()=>{if(!s)return;const r=x.current;if(!r)return;const i=r.querySelector(`[data-option-index="${v}"]`);i==null||i.scrollIntoView({block:"nearest"})},[s,v]);const C=d.useMemo(()=>n.find(r=>r.id===l)??n[0],[n,l]),A=d.useCallback(r=>{var i;y(!1),r!==l&&m(r),(i=a.current)==null||i.focus()},[m,l]),S=d.useCallback(()=>{y(r=>!r)},[]),D=d.useCallback(r=>{y(!0),M(i=>n.length===0?i:(i+r+n.length)%n.length)},[n.length]),F=d.useCallback(r=>{if(r.key==="ArrowDown"){r.preventDefault(),D(1);return}if(r.key==="ArrowUp"){r.preventDefault(),D(-1);return}if(r.key==="Enter"||r.key===" "){if(r.preventDefault(),!s){y(!0);return}const i=n[v];i&&A(i.id);return}r.key==="Escape"&&s&&(r.preventDefault(),y(!1))},[v,D,s,n,A]),P={position:"relative",width:O?"100%":u.width,pointerEvents:"auto"},$={width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"0.6rem",borderRadius:"12px",border:`1px solid ${s?g.borderActive:g.borderDefault}`,background:s?g.backgroundPressed:g.background,color:g.textPrimary,padding:u.triggerPadding,fontSize:u.triggerFontSize,lineHeight:1.4,cursor:"pointer",transition:"border-color 0.18s ease, background 0.2s ease, box-shadow 0.2s ease, transform 0.2s ease",boxShadow:s?g.shadowActive:g.shadowRest,textAlign:"left"},t={position:"fixed",left:`${(o==null?void 0:o.left)??-9999}px`,top:`${(o==null?void 0:o.top)??-9999}px`,width:`${(o==null?void 0:o.width)??0}px`,borderRadius:"12px",border:`1px solid ${g.borderHover}`,background:g.listBackground,boxShadow:"0 24px 54px rgba(8,14,26,0.65)",padding:_?"0.45rem":"0.35rem 0.4rem",display:"flex",flexDirection:"column",gap:"0.25rem",maxHeight:`${(o==null?void 0:o.maxHeight)??u.maxListHeight}px`,overflowY:"auto",opacity:s&&o?1:0,pointerEvents:s&&o?"auto":"none",transform:s&&o?"translateY(0)":`translateY(${(o==null?void 0:o.direction)==="up"?"6px":"-6px"})`,transition:"opacity 0.16s ease, transform 0.18s ease",zIndex:140},j=s&&o&&typeof document<"u"?oe.createPortal(e.jsx("div",{ref:x,id:L,role:"listbox","aria-activedescendant":s?`${L}-${((V=n[v])==null?void 0:V.id)??"inactive"}`:void 0,style:t,"data-open-direction":o.direction,"data-controller-focus-ignore":c?"true":void 0,children:n.map((r,i)=>{const h=r.id===l,N=i===v,p=!!r.summary;return e.jsxs("button",{type:"button",role:"option",id:`${L}-${r.id}`,"data-option-index":i,"aria-selected":h,style:Ee({config:u,isHighlighted:N,isSelected:h,hasSummary:p}),onMouseEnter:()=>M(i),onFocus:()=>M(i),onMouseDown:z=>{z.preventDefault()},onClick:()=>A(r.id),children:[e.jsx("span",{style:{fontSize:u.optionFontSize,fontWeight:h?600:500},children:r.name}),p?e.jsx("span",{style:Me(u),children:r.summary}):null]},r.id)})}),document.body):null;return e.jsxs("div",{ref:R,style:P,"data-controller-focus-ignore":c?"true":void 0,children:[e.jsxs("button",{type:"button",ref:a,id:k,"aria-haspopup":"listbox","aria-expanded":s,"aria-controls":L,style:$,onClick:S,onKeyDown:F,"data-testid":b,children:[e.jsx("span",{children:(C==null?void 0:C.name)??""}),e.jsx("span",{style:{...Ne,transform:`translateY(-50%) rotate(${s?180:0}deg)`},children:"▾"})]}),j]})},De=(...l)=>l.filter(Boolean).join(" "),ze=({onStartNewGame:l,onContinue:n,hasActiveGame:m})=>{const[w,O]=d.useState("landing"),c=le(),k=E(t=>t.settings.locale);E(t=>t.settings.testMode);const b=E(t=>t.settings.autoBattleEnabled),I=E(t=>t.settings.autoBattleProfile),L=E(t=>t.settings.lightsEnabled),u=E(t=>t.surveillance.hud.overlayEnabled),R=E(t=>t.hudLayout.override),a=de(k),x=a.autoBattle,s=R??"auto",y=t=>{t!==k&&(c(me(t)),c(ge(t)),c(xe(t)),c(he(t)))},v=()=>{const t=!L;c(be(t)),ye({lightsEnabled:t})},M=()=>{c(pe({enabled:!u}))},o=t=>{const j=t;if(j!==s){if(j==="auto"){c(J(null));return}c(J(j))}},H=[{id:"auto",name:a.menu.hudLayoutOptions.auto,summary:a.menu.hudLayoutDescription},{id:"exploration",name:a.menu.hudLayoutOptions.exploration,summary:a.menu.hudLayoutDescription},{id:"stealth",name:a.menu.hudLayoutOptions.stealth,summary:a.menu.hudLayoutDescription},{id:"combat",name:a.menu.hudLayoutOptions.combat,summary:a.menu.hudLayoutDescription}],_=H.find(t=>t.id===s)??H[0],W=t=>{if(t!==(b?I:"manual")){if(t==="manual"){b&&c(q(!1));return}b||c(q(!0)),t!==I&&c(fe(t))}},f=[{id:"manual",name:x.manualOption.name,summary:x.manualOption.summary},...ue.map(t=>({id:t,name:x.profiles[t].name,summary:x.profiles[t].summary}))],C=b?I:"manual",A=f.find(t=>t.id===C)??f[0],S="mb-[0.5rem] block text-[0.78rem] font-semibold uppercase tracking-[0.08em] text-[#94a3b8]",D="hud-menu-toggle flex cursor-pointer items-center gap-[0.65rem] rounded-[8px] border border-[rgba(148,163,184,0.25)] bg-[rgba(30,41,59,0.5)] px-[0.85rem] py-[0.5rem] transition-[background-color,border-color,box-shadow] duration-200 hover:border-[rgba(56,189,248,0.35)] hover:bg-[rgba(30,41,59,0.7)] hover:shadow-[0_0_12px_rgba(56,189,248,0.15)]",F="hud-menu-language-button rounded-[8px] border border-[rgba(148,163,184,0.25)] bg-[rgba(30,41,59,0.5)] px-[0.9rem] py-[0.5rem] text-[0.86rem] font-normal tracking-[0.03em] text-[#94a3b8] transition-all duration-200 hover:border-[rgba(56,189,248,0.4)] hover:text-[#f8fafc] hover:shadow-[0_0_12px_rgba(56,189,248,0.15)]",P="border-2 border-[rgba(56,189,248,0.6)] bg-[rgba(56,189,248,0.15)] font-semibold text-[#e2e8f0] shadow-[0_0_15px_rgba(56,189,248,0.2)]",$=()=>e.jsxs("div",{className:"flex flex-col gap-[1.25rem]",children:[e.jsx(T,{"data-testid":"start-new-game",onClick:l,variant:"success",size:"large",fullWidth:!0,icon:"▶",children:a.menu.start}),e.jsx(T,{"data-testid":"continue-game",onClick:n,variant:"secondary",size:"large",fullWidth:!0,disabled:!m,children:a.menu.resume})]});return e.jsx("div",{"data-testid":"game-menu","data-controller-focus-ignore":"true",className:"hud-menu-backdrop fixed inset-0 z-[80] flex items-center justify-center bg-[radial-gradient(circle_at_top,rgba(96,165,250,0.15),rgba(17,24,39,0.95))] font-body text-hud-text backdrop-blur-[4px]",children:e.jsxs("div",{className:"hud-menu-modal flex w-[min(520px,92%)] max-h-[90vh] flex-col overflow-y-auto rounded-[18px] border border-[rgba(148,163,184,0.25)] bg-[rgba(15,23,42,0.92)] px-[2.25rem] py-[1.85rem] text-[#f8fafc] shadow-[0_24px_50px_rgba(15,23,42,0.45)]",children:[e.jsxs("div",{className:"mb-[0.9rem] flex flex-col items-center text-center",children:[e.jsx("div",{className:"mb-[1.1rem] flex justify-center",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64",className:"h-[68px] w-[68px]",children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"menuBgGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#1e293b",stopOpacity:1}),e.jsx("stop",{offset:"100%",stopColor:"#0f172a",stopOpacity:1})]}),e.jsxs("linearGradient",{id:"menuGlowGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#38bdf8",stopOpacity:1}),e.jsx("stop",{offset:"100%",stopColor:"#0ea5e9",stopOpacity:1})]})]}),e.jsx("circle",{cx:"32",cy:"32",r:"32",fill:"url(#menuBgGradient)"}),e.jsx("path",{d:"M32 16 L46 24 L32 32 L18 24 Z",fill:"#475569",opacity:"0.6"}),e.jsx("circle",{cx:"32",cy:"32",r:"10",fill:"none",stroke:"url(#menuGlowGradient)",strokeWidth:"2.5"}),e.jsx("circle",{cx:"32",cy:"32",r:"6",fill:"none",stroke:"url(#menuGlowGradient)",strokeWidth:"1.5"}),e.jsx("line",{x1:"32",y1:"22",x2:"32",y2:"26",stroke:"#38bdf8",strokeWidth:"2",strokeLinecap:"round"}),e.jsx("line",{x1:"32",y1:"38",x2:"32",y2:"42",stroke:"#38bdf8",strokeWidth:"2",strokeLinecap:"round"}),e.jsx("line",{x1:"22",y1:"32",x2:"26",y2:"32",stroke:"#38bdf8",strokeWidth:"2",strokeLinecap:"round"}),e.jsx("line",{x1:"38",y1:"32",x2:"42",y2:"32",stroke:"#38bdf8",strokeWidth:"2",strokeLinecap:"round"}),e.jsx("circle",{cx:"32",cy:"32",r:"2",fill:"#38bdf8"}),e.jsx("path",{d:"M8 8 L12 8 L12 12",fill:"none",stroke:"#0ea5e9",strokeWidth:"1.5",opacity:.4}),e.jsx("path",{d:"M56 8 L52 8 L52 12",fill:"none",stroke:"#0ea5e9",strokeWidth:"1.5",opacity:.4}),e.jsx("path",{d:"M8 56 L12 56 L12 52",fill:"none",stroke:"#0ea5e9",strokeWidth:"1.5",opacity:.4}),e.jsx("path",{d:"M56 56 L52 56 L52 52",fill:"none",stroke:"#0ea5e9",strokeWidth:"1.5",opacity:.4})]})}),e.jsx("p",{className:"mb-[0.75rem] text-[0.875rem] uppercase tracking-[0.35em] text-[#60a5fa]",children:a.menu.tag}),e.jsx("h1",{className:"mb-[0.45rem] text-[2.48rem] font-bold",style:{...ve("#bfdbfe","#38bdf8"),filter:"drop-shadow(0 0 20px rgba(56, 189, 248, 0.5))",lineHeight:"1.08",paddingBottom:"0.1rem"},children:a.menu.title})]}),w==="landing"?e.jsxs(e.Fragment,{children:[$(),e.jsx("div",{className:"mt-[1.1rem]",children:e.jsx(T,{"data-testid":"menu-open-settings",onClick:()=>O("settings"),variant:"primary",size:"large",fullWidth:!0,children:a.menu.settingsCTA})})]}):e.jsxs("div",{"data-testid":"menu-settings-panel",className:"hud-menu-section mt-[0.35rem] flex flex-col gap-[0.9rem] rounded-[14px] border border-[rgba(148,163,184,0.25)] bg-[rgba(15,23,42,0.6)] p-[0.82rem]",children:[e.jsx("div",{className:"hud-menu-section__header border-b border-[rgba(148,163,184,0.15)] pb-[0.5rem]",children:e.jsx("h2",{className:"m-0 text-[0.95rem] font-semibold uppercase tracking-[0.05em] text-[#e2e8f0]",children:a.menu.settingsHeading})}),e.jsxs("div",{className:"flex flex-col gap-[0.75rem]",children:[e.jsxs("div",{children:[e.jsx("label",{className:S,children:a.menu.languageLabel}),e.jsx("div",{className:"hud-menu-language-list flex flex-wrap gap-[0.45rem]",children:ce.map(t=>{const j=t===k;return e.jsx("button",{type:"button",onClick:()=>y(t),className:De(F,j&&P),children:a.menu.languageNames[t]},t)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:S,htmlFor:"auto-battle-mode-select",children:x.heading}),e.jsxs("div",{className:"flex flex-col gap-[0.4rem]",children:[e.jsx(te,{triggerId:"auto-battle-mode-select",value:C,onChange:W,options:f,variant:"menu",fullWidth:!0,dataFocusIgnore:!0,triggerTestId:"menu-autobattle-dropdown"}),e.jsx("div",{className:"text-[0.64rem] text-[#a5b4d5] leading-[1.35]",children:A.summary})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:S,children:a.menu.surveillanceLabel}),e.jsxs("label",{className:D,children:[e.jsx("input",{type:"checkbox",checked:u,onChange:M,className:"h-5 w-5 cursor-pointer accent-[#38bdf8]"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-[0.95rem] font-medium text-[#e2e8f0]",children:a.menu.surveillanceToggleLabel}),e.jsx("div",{className:"mt-[0.1rem] text-[0.66rem] text-[#94a3b8]",children:a.menu.surveillanceToggleDescription})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:S,children:a.menu.lightingLabel}),e.jsxs("label",{className:D,children:[e.jsx("input",{type:"checkbox",checked:L,onChange:v,className:"h-5 w-5 cursor-pointer accent-[#38bdf8]"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-[0.95rem] font-medium text-[#e2e8f0]",children:a.menu.lightingToggleLabel}),e.jsx("div",{className:"mt-[0.1rem] text-[0.66rem] text-[#94a3b8]",children:a.menu.lightingToggleDescription})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:S,htmlFor:"hud-layout-select",children:a.menu.hudLayoutLabel}),e.jsxs("div",{className:"flex flex-col gap-[0.35rem]",children:[e.jsx(te,{triggerId:"hud-layout-select",value:s,onChange:o,options:H,variant:"menu",fullWidth:!0,dataFocusIgnore:!0,triggerTestId:"menu-hud-layout-dropdown"}),e.jsx("div",{className:"text-[0.64rem] leading-[1.35] text-[#a5b4d5]",children:_.summary})]})]}),!1]})]}),w==="settings"&&e.jsx("div",{className:"mt-[0.75rem]",children:e.jsx(T,{"data-testid":"menu-close-settings",onClick:()=>O("landing"),variant:"secondary",size:"medium",fullWidth:!0,children:a.menu.settingsBack})}),e.jsxs("div",{className:"mt-[1.1rem] flex flex-wrap items-center justify-center gap-[0.65rem] text-center text-[0.75rem] uppercase tracking-[0.22em] text-[#64748b]",children:[e.jsx("span",{children:a.menu.alphaLabel(Se)}),e.jsxs("span",{className:"inline-flex items-center gap-[0.35rem] text-[#94a3b8]",children:[e.jsx("span",{"aria-hidden":"true",children:"•"}),e.jsx("span",{children:`v${Le}`})]})]})]})})};export{ze as default};
