import{f as z,u as j,r as u,j as e}from"./vendor-Cc93p67d.js";import{s as T,n as L,e as R}from"./game-content-DAoogAxc.js";import{bJ as B}from"./game-core-BM07RTDL.js";import"./phaser-DkaA9Y8j.js";const $={position:"fixed",inset:0,zIndex:12e3,backgroundColor:"rgba(8, 15, 31, 0.9)",display:"flex",justifyContent:"center",alignItems:"center",padding:"3vh 3vw"},P={width:"min(1040px, 92vw)",maxHeight:"92vh",overflowY:"auto",background:"linear-gradient(160deg, rgba(15, 23, 42, 0.98), rgba(8, 11, 24, 0.92))",borderRadius:"18px",border:"1px solid rgba(56, 189, 248, 0.25)",boxShadow:"0 40px 90px rgba(2, 6, 23, 0.75)",color:"#e2e8f0",display:"flex",flexDirection:"column"},D={padding:"1.4rem 1.6rem 1rem",borderBottom:"1px solid rgba(56, 189, 248, 0.18)",display:"flex",justifyContent:"space-between",alignItems:"flex-start"},H={fontSize:"1.35rem",fontWeight:700,letterSpacing:"0.12em",textTransform:"uppercase",margin:0},I={marginTop:"0.35rem",fontSize:"0.75rem",letterSpacing:"0.08em",color:"rgba(148, 163, 184, 0.78)"},q={padding:"1.4rem 1.6rem 2rem",display:"flex",flexDirection:"column",gap:"1.2rem"},M={fontSize:"0.85rem",letterSpacing:"0.14em",textTransform:"uppercase",color:"#38bdf8",marginBottom:"0.6rem"},W={display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:"1rem"},A=r=>({borderRadius:"14px",border:`1px solid ${r?"rgba(148, 163, 184, 0.16)":"rgba(56, 189, 248, 0.24)"}`,background:r?"linear-gradient(150deg, rgba(15, 23, 42, 0.72), rgba(15, 23, 42, 0.85))":"linear-gradient(150deg, rgba(15, 23, 42, 0.9), rgba(12, 18, 34, 0.92))",padding:"1.1rem",display:"flex",flexDirection:"column",gap:"0.65rem",boxShadow:r?"none":"0 20px 32px rgba(56, 189, 248, 0.12)",minHeight:"220px"}),E={fontSize:"1rem",fontWeight:700,letterSpacing:"0.05em",display:"flex",alignItems:"center",gap:"0.4rem"},U={fontSize:"0.55rem",letterSpacing:"0.16em",textTransform:"uppercase",padding:"0.2rem 0.5rem",borderRadius:"999px",border:"1px solid rgba(251, 191, 36, 0.55)",background:"rgba(251, 191, 36, 0.16)",color:"#fbbf24"},m={fontSize:"0.7rem",letterSpacing:"0.12em",textTransform:"uppercase",color:"rgba(148, 163, 184, 0.78)"},G={fontSize:"0.8rem",lineHeight:1.5,color:"rgba(226, 232, 240, 0.9)"},J={margin:0,paddingLeft:"1.1rem",fontSize:"0.78rem",color:"rgba(226, 232, 240, 0.82)"},N=r=>({marginTop:"auto",alignSelf:"flex-start",padding:"0.55rem 1rem",borderRadius:"999px",border:"1px solid rgba(56, 189, 248, 0.5)",background:r?"linear-gradient(135deg, rgba(30, 41, 59, 0.75), rgba(15, 23, 42, 0.78))":"linear-gradient(135deg, rgba(37, 99, 235, 0.65), rgba(56, 189, 248, 0.7))",color:r?"rgba(148, 163, 184, 0.7)":"#e0f2fe",letterSpacing:"0.14em",fontSize:"0.62rem",textTransform:"uppercase",cursor:r?"not-allowed":"pointer",transition:"transform 0.15s ease"}),O={padding:"1rem 1.6rem 1.4rem",borderTop:"1px solid rgba(56, 189, 248, 0.18)",display:"flex",justifyContent:"flex-end"},Y=r=>({padding:"0.5rem 0.7rem",borderRadius:"8px",border:"1px solid rgba(148, 163, 184, 0.4)",background:r?"rgba(15, 23, 42, 0.6)":"rgba(15, 23, 42, 0.85)",color:r?"rgba(148, 163, 184, 0.6)":"#e2e8f0",fontSize:"1rem",cursor:r?"not-allowed":"pointer",transition:"all 0.2s ease",opacity:r?.6:1}),F=r=>({padding:"0.6rem 1.4rem",borderRadius:"999px",border:`1px solid ${r?"rgba(148, 163, 184, 0.3)":"rgba(56, 189, 248, 0.5)"}`,background:r?"linear-gradient(135deg, rgba(30, 41, 59, 0.75), rgba(15, 23, 42, 0.78))":"linear-gradient(135deg, rgba(37, 99, 235, 0.65), rgba(56, 189, 248, 0.7))",color:r?"rgba(148, 163, 184, 0.6)":"#e0f2fe",letterSpacing:"0.16em",fontSize:"0.7rem",textTransform:"uppercase",cursor:r?"not-allowed":"pointer",fontWeight:600,transition:"all 0.2s ease"}),x=r=>r.length===0?null:e.jsx("ul",{style:J,children:r.map(l=>e.jsx("li",{children:l},l))}),Z=({open:r,pendingSelections:l,onClose:y})=>{const v=z(),i=j(t=>t.player.data),C=j(t=>t.settings.locale),s=L(C),f=u.useMemo(()=>["combat","utility","dialogue","capstone"],[]),b=u.useMemo(()=>f.map(t=>{const o=T(t);return{category:t,label:s.perks.categoryLabels[t],perks:o.map(g=>{const a=R(i,g);return{definition:g,availability:a}})}}).filter(t=>t.perks.length>0),[f,i,s.perks.categoryLabels]),c=u.useMemo(()=>b.some(t=>t.perks.some(({availability:o})=>o.canSelect)),[b]),d=l>0&&c;if(!r)return null;const w=(t,o)=>{!o||l<=0||v(B(t))};return e.jsx("div",{style:$,role:"dialog","aria-modal":"true","aria-label":s.perks.panelTitle,children:e.jsxs("div",{style:P,children:[e.jsxs("header",{style:D,children:[e.jsxs("div",{children:[e.jsx("h2",{style:H,children:s.perks.panelTitle}),e.jsx("div",{style:I,children:s.perks.remainingLabel(l)})]}),e.jsx("button",{type:"button",style:Y(d),onClick:d?void 0:y,disabled:d,title:d?"Spend all perk selections before closing":"Close","aria-disabled":d,children:"âœ•"})]}),e.jsxs("div",{style:q,children:[l>0&&!c&&e.jsx("div",{style:{background:"rgba(56, 189, 248, 0.12)",border:"1px solid rgba(56, 189, 248, 0.3)",borderRadius:"10px",padding:"0.9rem",marginBottom:"0.8rem",color:"rgba(226, 232, 240, 0.9)",fontSize:"0.75rem",lineHeight:1.45},children:"All current perks are either already owned or locked. Spend your new attribute or skill points to unlock additional choices, or continue to return later."}),b.map(({category:t,label:o,perks:g})=>e.jsxs("section",{children:[e.jsx("h3",{style:M,children:o}),e.jsx("div",{style:W,children:g.map(({definition:a,availability:n})=>{var S,k;const h=!n.canSelect;return e.jsxs("article",{style:A(h),children:[e.jsxs("div",{style:E,children:[e.jsx("span",{children:a.name}),a.capstone&&e.jsx("span",{style:U,children:s.perks.capstoneTag})]}),e.jsx("div",{style:G,children:a.description}),a.effects.length>0&&e.jsxs("div",{children:[e.jsx("div",{style:m,children:s.perks.effectsLabel}),x(a.effects)]}),e.jsxs("div",{children:[e.jsx("div",{style:m,children:s.perks.requirementsLabel}),x([`Level ${a.levelRequirement}`,...((S=a.attributeRequirements)==null?void 0:S.map(p=>`${p.attribute.toUpperCase()} ${p.value}`))??[],...((k=a.skillRequirements)==null?void 0:k.map(p=>`${p.skill} ${p.value}`))??[]])]}),h&&n.reasons.length>0&&e.jsxs("div",{children:[e.jsx("div",{style:m,children:s.perks.lockedLabel}),x(n.reasons)]}),i.perks.includes(a.id)&&e.jsx("div",{style:{...m,color:"#fbbf24"},children:s.perks.alreadyOwnedLabel}),e.jsx("button",{type:"button",style:N(!n.canSelect||l<=0||i.perks.includes(a.id)),onClick:()=>w(a.id,n.canSelect),disabled:!n.canSelect||l<=0||i.perks.includes(a.id),children:s.perks.selectLabel})]},a.id)})})]},t))]}),e.jsx("footer",{style:O,children:e.jsx("button",{type:"button",style:F(l>0&&c),onClick:y,disabled:l>0&&c,title:l>0&&c?"Select all available perks before continuing":"Continue",children:"Continue"})})]})})};export{Z as default};
