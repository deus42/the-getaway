import{R as he,f as xe,u as L,r as s,j as e}from"./vendor-Cc93p67d.js";import{c as J,a as qe,b as H,d as oe,g as tr,s as w,e as rr,n as z,f as nr,P as ar}from"./index-B0UVSZ8-.js";import{n as Z,a as lr,r as ir,g as Re}from"./game-content-DAoogAxc.js";import{bp as or,bq as sr,aR as cr,aS as dr,br as pr,bs as ge,bt as Qe,J as ur,bu as mr,bv as br,bw as yr,bx as gr,by as fr,bz as Dt,bA as $t,aY as hr,bB as Je,bC as xr,bD as Sr,bE as We,bF as Xe,bG as Ze,bH as jr,bI as vr,ab as et}from"./game-core-BaZ5YJaJ.js";import{N as Le,T as At,a as Rt}from"./Tooltip-CnX58fCC.js";import"./phaser-DkaA9Y8j.js";const tt={strength:{key:"strength",abbreviation:"STR",min:1,max:10,focus:"combat"},perception:{key:"perception",abbreviation:"PER",min:1,max:10,focus:"perception"},endurance:{key:"endurance",abbreviation:"END",min:1,max:10,focus:"survival"},charisma:{key:"charisma",abbreviation:"CHA",min:1,max:10,focus:"social"},intelligence:{key:"intelligence",abbreviation:"INT",min:1,max:10,focus:"intellect"},agility:{key:"agility",abbreviation:"AGI",min:1,max:10,focus:"mobility"},luck:{key:"luck",abbreviation:"LCK",min:1,max:10,focus:"fortuity"}},kr=(r,n,u)=>Number.isNaN(r)||r<n?n:r>u?u:r,Cr=r=>Object.keys(tt).map(n=>{const u=tt[n],m=r[n],l=kr(m,u.min,u.max),v=Math.max(1,u.max-u.min),g=(l-u.min)/v;return{key:n,abbreviation:u.abbreviation,value:l,min:u.min,max:u.max,normalized:g,focus:u.focus}}),wr={...J,display:"flex",flexDirection:"column",gap:"0.5rem"},rt={...qe},nt={...H},at={...oe},lt={display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"0.25rem"},it={display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.3rem 0.4rem",borderRadius:"5px",background:"rgba(30, 41, 59, 0.4)",border:"1px solid rgba(148, 163, 184, 0.12)"},ot={display:"flex",alignItems:"center",gap:"0.3rem",fontSize:"0.62rem",color:"#cbd5e1"},Mr=r=>({display:"inline-flex",alignItems:"center",justifyContent:"center",padding:"0.08rem 0.25rem",borderRadius:"3px",fontSize:"0.5rem",fontWeight:600,letterSpacing:"0.06em",textTransform:"uppercase",color:"#f8fafc",background:r}),st={fontSize:"0.75rem",fontWeight:600,color:"#f8fafc"},Ir={display:"flex",alignItems:"center",gap:"0.25rem"},Tr={display:"flex",flexDirection:"column",gap:"0.2rem",padding:"0.35rem 0.45rem",borderRadius:"6px",border:"1px solid rgba(94, 234, 212, 0.35)",background:"rgba(15, 118, 110, 0.15)"},Wr={display:"flex",alignItems:"center",justifyContent:"space-between"},zr={fontSize:"0.58rem",letterSpacing:"0.14em",textTransform:"uppercase",color:"rgba(94, 234, 212, 0.95)"},Pr={fontSize:"0.58rem",color:"rgba(203, 213, 225, 0.9)",margin:0},Dr=r=>({padding:"0.2rem 0.35rem",borderRadius:"5px",border:"1px solid rgba(94, 234, 212, 0.6)",background:r?"rgba(148, 163, 184, 0.18)":"rgba(94, 234, 212, 0.18)",color:r?"rgba(148, 163, 184, 0.8)":"#5eead4",fontSize:"0.6rem",fontWeight:600,letterSpacing:"0.07em",textTransform:"uppercase",cursor:r?"not-allowed":"pointer",transition:"all 0.2s ease",minWidth:"3.75rem",textAlign:"center"}),$r={display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0.6rem",borderRadius:"8px",border:"1px solid rgba(251, 191, 36, 0.35)",background:"rgba(217, 119, 6, 0.15)",fontSize:"0.68rem",color:"rgba(254, 243, 199, 0.95)"},ct={combat:"linear-gradient(135deg, rgba(239, 68, 68, 0.85), rgba(248, 113, 113, 0.85))",perception:"linear-gradient(135deg, rgba(56, 189, 248, 0.85), rgba(59, 130, 246, 0.85))",survival:"linear-gradient(135deg, rgba(45, 212, 191, 0.85), rgba(16, 185, 129, 0.85))",social:"linear-gradient(135deg, rgba(244, 114, 182, 0.85), rgba(236, 72, 153, 0.85))",intellect:"linear-gradient(135deg, rgba(165, 180, 252, 0.85), rgba(99, 102, 241, 0.85))",mobility:"linear-gradient(135deg, rgba(96, 165, 250, 0.85), rgba(37, 99, 235, 0.85))",fortuity:"linear-gradient(135deg, rgba(250, 204, 21, 0.85), rgba(245, 158, 11, 0.85))"},Ar=()=>{const r=xe(),n=L(h=>h.player.data),u=L(h=>h.settings.locale),m=Z(u),l=m.playerStatsPanel,v=s.useMemo(()=>({combat:l.focusLabel(m.statFocus.combat),perception:l.focusLabel(m.statFocus.perception),survival:l.focusLabel(m.statFocus.survival),social:l.focusLabel(m.statFocus.social),intellect:l.focusLabel(m.statFocus.intellect),mobility:l.focusLabel(m.statFocus.mobility),fortuity:l.focusLabel(m.statFocus.fortuity)}),[l,m.statFocus]),g=s.useMemo(()=>{const h=or(n);return sr(n.skills,h)},[n]),k=s.useMemo(()=>Cr(g),[g]),{derived:c,equipmentError:A}=s.useMemo(()=>{try{return{derived:cr(n),equipmentError:!1}}catch(h){return console.warn("[PlayerStatsPanel] Unable to use equipment-aware stats, falling back to base attributes.",h),{derived:dr(n.skills),equipmentError:!0}}},[n]),j=n.attributePoints,P=j>0,B=h=>{r(pr(h))},R=h=>{const{increaseAttribute:D}=m.playerStatus;return typeof D=="function"?D(h):typeof D=="string"?D:`Increase ${h}`},E=[{label:m.playerStatus.derivedStats.hp,value:c.maxHP},{label:m.playerStatus.derivedStats.stamina,value:c.maxStamina},{label:m.playerStatus.derivedStats.carryWeight,value:`${c.carryWeight} kg`},{label:m.playerStatus.derivedStats.crit,value:`${c.criticalChance}%`},{label:m.playerStatus.derivedStats.hit,value:`+${c.hitChanceModifier}%`},{label:m.playerStatus.derivedStats.dodge,value:`+${c.dodgeChance}%`}];return e.jsxs("section",{style:wr,"aria-label":l.ariaLabel,children:[e.jsxs("header",{style:rt,children:[e.jsx("span",{style:nt,children:m.playerStatus.attributesLabel}),e.jsx("h3",{style:at,children:m.playerStatus.attributesTitle})]}),A&&e.jsxs("div",{style:$r,role:"alert",children:[e.jsx("span",{children:"⚠️"}),e.jsx("span",{children:l.equipmentWarning})]}),P&&e.jsxs("div",{style:Tr,role:"group","aria-label":m.playerStatus.attributePointsLabel,children:[e.jsxs("div",{style:Wr,children:[e.jsx("span",{style:zr,children:m.playerStatus.attributePointsLabel}),e.jsx(Le,{count:j,color:"#5eead4",size:22,pulse:j>0})]}),e.jsx("p",{style:Pr,children:m.playerStatus.attributePointsHint})]}),e.jsx("div",{style:lt,children:k.map(h=>{const D=m.skills[h.key],o=ct[h.focus]??ct.combat,f=n.skills[h.key],i=f!==h.value,d=f>=10||j<=0,x=R(h.abbreviation),T=[l.rankLabel(h.value)];return i&&T.push(l.baseLabel(f)),T.push(v[h.focus]),e.jsx(At,{content:e.jsx(Rt,{title:D,description:m.skillDescriptions[h.key],meta:T}),children:e.jsxs("div",{style:it,children:[e.jsxs("div",{style:ot,children:[e.jsx("span",{style:Mr(o),children:h.abbreviation}),e.jsx("span",{children:D})]}),e.jsxs("div",{style:Ir,children:[e.jsxs("span",{style:{...st,color:i?"#22c55e":"#f8fafc"},children:[h.value,i&&e.jsxs("span",{style:{fontSize:"0.65rem",marginLeft:"0.2rem",opacity:.6},children:["(",f,")"]})]}),P&&e.jsx("button",{type:"button",style:Dr(d),disabled:d,onClick:()=>B(h.key),"aria-label":x,title:d&&f>=10?m.playerStatus.attributeMaxed:x,children:"+1"})]})]})},h.key)})}),e.jsxs("header",{style:{...rt,marginTop:"0.4rem"},children:[e.jsx("span",{style:nt,children:m.playerStatus.derivedLabel}),e.jsx("h3",{style:at,children:m.playerStatus.derivedTitle})]}),e.jsx("div",{style:lt,children:E.map(h=>e.jsxs("div",{style:it,children:[e.jsx("span",{style:ot,children:h.label}),e.jsx("span",{style:st,children:h.value})]},h.label))})]})},Rr=he.memo(Ar),ze=ur("SkillTreePanel"),qr={background:"transparent",border:"none",borderRadius:"14px",padding:"0.6rem",display:"flex",flexDirection:"column",gap:"0.45rem",minHeight:0,height:"100%",overflow:"hidden"},Lr={display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem",flexShrink:0},Br={margin:0,fontSize:"0.75rem",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.08em",...tr("#bfdbfe","#38bdf8"),filter:"drop-shadow(0 0 8px rgba(56, 189, 248, 0.4))"},Er={display:"grid",gridTemplateColumns:"repeat(4, minmax(0, 1fr))",gap:"0.3rem",flexShrink:0,isolation:"isolate"},Fr=r=>({padding:"0.4rem 0.3rem",borderRadius:"6px",border:`1px solid ${r?"#38bdf8":"rgba(148, 163, 184, 0.25)"}`,background:r?"rgba(56, 189, 248, 0.25)":"rgba(15, 23, 42, 0.6)",color:r?"#f8fafc":"#94a3b8",fontSize:"0.62rem",fontWeight:600,letterSpacing:"0.06em",textTransform:"uppercase",cursor:"pointer",transition:"all 0.15s ease",outline:"none",userSelect:"none",WebkitTapHighlightColor:"transparent",minHeight:"32px",display:"flex",alignItems:"center",justifyContent:"center",position:"relative",zIndex:1e3}),Hr={display:"flex",flexDirection:"column",gap:"0.35rem",minHeight:0,flex:1,overflowY:"hidden",paddingRight:"0.3rem",position:"relative",zIndex:0},Or={display:"grid",gridTemplateColumns:"1fr auto",gap:"0.4rem",alignItems:"center"},Nr={display:"flex",flexDirection:"column",gap:"0.1rem"},_r={display:"flex",alignItems:"center",gap:"0.5rem"},Ur={padding:"0.1rem 0.3rem",borderRadius:"999px",fontSize:"0.5rem",letterSpacing:"0.06em",textTransform:"uppercase",background:"rgba(245, 158, 11, 0.18)",border:"1px solid rgba(245, 158, 11, 0.45)",color:"#f59e0b",fontWeight:600},dt={display:"flex",alignItems:"center",justifyContent:"center",gap:"0.4rem"},Vr={minWidth:"38px",textAlign:"center",fontWeight:700,color:"#f8fafc",fontSize:"0.8rem"},pt=r=>({width:"26px",height:"26px",borderRadius:"6px",border:`1px solid ${r?"rgba(148, 163, 184, 0.3)":"rgba(56, 189, 248, 0.5)"}`,background:r?"rgba(15, 23, 42, 0.45)":"rgba(56, 189, 248, 0.2)",color:r?"#64748b":"#e0f2fe",cursor:r?"not-allowed":"pointer",fontSize:"0.85rem",fontWeight:700,display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.15s ease",lineHeight:1}),ut={fontSize:"0.55rem",color:"#94a3b8",lineHeight:1.25},Gr={fontSize:"0.53rem",color:"rgba(148, 163, 184, 0.75)",lineHeight:1.25},Pe={fontSize:"0.53rem",color:"rgba(148, 163, 184, 0.7)"},Kr={position:"absolute",width:1,height:1,overflow:"hidden",clip:"rect(1px, 1px, 1px, 1px)"},Yr=r=>{const n=ge.find(u=>u.id===r);if(!n)throw new Error(`[SkillTreePanel] Unknown branch id: ${r}`);return n},Qr=()=>{const r=xe(),n=L(o=>o.player.data),u=L(o=>o.settings.locale),l=Z(u).skillTreePanel,v=n.skillPoints,g=s.useMemo(()=>{var f;const o=ge.map(i=>{const d=i.skills.reduce((x,T)=>x+(n.skillTraining[T.id]??0),0);return{id:i.id,total:d}});return o.sort((i,d)=>d.total-i.total),((f=o[0])==null?void 0:f.id)??"combat"},[n.skillTraining]),[k,c]=s.useState(g),[A,j]=s.useState(""),P=s.useRef({combat:null,tech:null,survival:null,social:null}),B=s.useRef(n.skillTraining);s.useEffect(()=>{B.current=n.skillTraining},[n.skillTraining]),s.useEffect(()=>{const o=B.current,f=n.skillTraining;if(o!==f){for(const i of ge)for(const d of i.skills){const x=o[d.id],T=f[d.id];if(x!==T){const M=Qe(d.id,T),O=(T??0)-(x??0)>0?"increase":"decrease";j(l.announcement(d.name,O,T??0,M)),B.current=f;return}}B.current=f}},[n.skillTraining,l]);const R=s.useCallback(o=>{ze.debug("Switching to branch:",o),c(o);const f=P.current[o];f&&f.focus()},[]),E=s.useCallback((o,f)=>{if(o.key!=="ArrowLeft"&&o.key!=="ArrowRight")return;o.preventDefault();const i=["combat","tech","survival","social"],d=i.indexOf(f);if(d===-1)return;const x=o.key==="ArrowLeft"?(d+i.length-1)%i.length:(d+1)%i.length;R(i[x])},[R]),h=o=>{const f=mr(n,o.id),i=br(n,o.id),d=yr(n,o.id),x=Qe(o.id,f),T=l.incrementLabel(d,i),M=v>0&&f+d<=o.maxValue,W=f-d>=0&&f>0;return e.jsxs("div",{style:Or,children:[e.jsxs("div",{style:Nr,children:[e.jsxs("div",{style:_r,children:[e.jsx("span",{style:{fontSize:"0.68rem",fontWeight:600,color:"#f8fafc"},children:o.name}),i&&e.jsx("span",{style:Ur,children:l.tagBadge})]}),e.jsx("p",{style:Gr,children:o.description}),e.jsx("p",{style:ut,children:x}),e.jsx("p",{style:{...ut,color:"rgba(148, 163, 184, 0.6)"},children:T})]}),e.jsxs("div",{style:dt,children:[e.jsx("button",{type:"button",style:pt(!W),disabled:!W,"aria-label":l.decreaseAria(o.name),onClick:()=>r(gr(o.id)),children:"−"}),e.jsx("span",{style:Vr,"data-testid":`skill-value-${o.id}`,children:f}),e.jsx("button",{type:"button",style:pt(!M),disabled:!M,"aria-label":l.increaseAria(o.name),onClick:()=>r(fr(o.id)),children:"+"})]})]},o.id)},D=Yr(k);return ze.debug("Render - Active branch:",k,"Branch:",D.label),e.jsxs("section",{style:qr,"aria-labelledby":"skill-tree-title",children:[e.jsxs("div",{style:Lr,children:[e.jsx("h2",{id:"skill-tree-title",style:Br,children:l.title}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("span",{style:Pe,children:l.baseHint}),e.jsxs("div",{style:dt,children:[e.jsx(Le,{count:v,color:"#38bdf8",size:22,pulse:v>0}),e.jsx("span",{style:{...Pe,fontSize:"0.6rem"},"aria-live":"polite",children:l.pointsLabel(v)})]})]})]}),e.jsx("div",{role:"tablist","aria-label":l.tablistAria,style:Er,children:ge.map(o=>{const f=k===o.id;return e.jsx("button",{type:"button",role:"tab","data-branch-id":o.id,"data-testid":`skill-tab-${o.id}`,ref:i=>{P.current[o.id]=i},"aria-selected":f,"aria-controls":`skill-branch-${o.id}`,id:`skill-tab-${o.id}`,tabIndex:0,onKeyDown:i=>E(i,o.id),onClick:()=>{ze.debug("Tab clicked:",o.id,o.label),R(o.id)},style:Fr(f),children:l.branches[o.id]??o.label},o.id)})}),e.jsxs("div",{id:`skill-branch-${D.id}`,role:"tabpanel","aria-labelledby":`skill-tab-${D.id}`,style:Hr,children:[e.jsx("p",{style:{...Pe,marginBottom:"0.2rem"},children:D.blurb}),D.skills.map(h)]}),e.jsx("div",{"aria-live":"polite",style:Kr,children:A})]})},Jr={...J,display:"flex",flexDirection:"column",gap:"0.65rem",minHeight:0,height:"100%",overflow:"hidden"},Xr={flex:1,minHeight:0,display:"flex",flexDirection:"column",gap:"0.85rem",overflowY:"auto",paddingRight:"0.2rem"},Zr={display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:"0.9rem",alignContent:"start"},mt={display:"flex",flexDirection:"column",gap:"0.32rem",padding:"0.6rem 0.7rem",borderRadius:"10px",background:"rgba(30, 41, 59, 0.55)",border:"1px solid rgba(148, 163, 184, 0.22)",color:"#e2e8f0",fontSize:"0.68rem"},en={fontSize:"0.78rem",fontWeight:700,letterSpacing:"0.05em"},bt=r=>({alignSelf:"flex-start",padding:"0.22rem 0.45rem",borderRadius:"999px",fontSize:"0.56rem",letterSpacing:"0.14em",textTransform:"uppercase",border:`1px solid ${r}`,color:r,background:"rgba(15, 23, 42, 0.7)"}),fe={display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"0.64rem",color:"rgba(226, 232, 240, 0.86)"},De={...fe,fontWeight:600},yt={display:"flex",flexWrap:"wrap",gap:"0.4rem",marginTop:"0.25rem"},gt={...w,letterSpacing:"0.12em",textTransform:"uppercase"},ft={...rr,fontSize:"0.8rem"},tn={display:"flex",flexWrap:"wrap",gap:"0.45rem",paddingTop:"0.35rem"},K={primaryWeapon:"rgba(56, 189, 248, 0.75)",secondaryWeapon:"rgba(59, 130, 246, 0.65)",meleeWeapon:"rgba(251, 191, 36, 0.75)",bodyArmor:"rgba(96, 165, 250, 0.75)",helmet:"rgba(147, 197, 253, 0.75)",accessory1:"rgba(236, 72, 153, 0.65)",accessory2:"rgba(236, 72, 153, 0.65)"},ht={display:"inline-flex",alignItems:"center",justifyContent:"center",padding:"0.32rem 0.6rem",borderRadius:"999px",background:"rgba(76, 29, 149, 0.16)",border:"1px solid rgba(192, 132, 252, 0.45)",color:"#f3e8ff",fontSize:"0.6rem",letterSpacing:"0.14em",textTransform:"uppercase",minHeight:"34px"},rn={...qe},nn={...H},an={...oe},Se={alignSelf:"flex-start",padding:"0.3rem 0.55rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:"rgba(30, 41, 59, 0.65)",color:"#e2e8f0",fontSize:"0.56rem",letterSpacing:"0.1em",textTransform:"uppercase",cursor:"pointer",transition:"background 0.15s ease, border-color 0.15s ease"},ln={...Se,borderColor:"rgba(248, 113, 113, 0.55)",background:"rgba(248, 113, 113, 0.18)"},on={...Se,borderColor:"rgba(56, 189, 248, 0.55)",background:"rgba(56, 189, 248, 0.18)"},sn={...Se,borderColor:"rgba(96, 165, 250, 0.55)",background:"rgba(96, 165, 250, 0.18)"},cn={...Se,borderColor:"rgba(236, 72, 153, 0.55)",background:"rgba(236, 72, 153, 0.18)"},dn=r=>{if(r.equipSlot)return r.equipSlot;if("damage"in r){const n=r.range,u=r.skillType;return typeof n=="number"&&n<=1||u==="meleeCombat"?"meleeWeapon":"primaryWeapon"}return"protection"in r?"bodyArmor":null},pn=r=>!!(r&&"damage"in r),un=r=>!!(r&&"protection"in r),mn=()=>{const r=xe(),n=L(i=>i.player.data),u=L(i=>i.settings.locale),m=Z(u),l=m.loadoutPanel,v=m.inventoryPanel,g=m.playerStatus.loadUnit,k=s.useCallback(i=>`${(Number.isFinite(i)?Math.round(i*10)/10:0).toFixed(1)} ${g}`,[g]),c=s.useCallback(i=>{if(!i||i.max<=0)return null;const d=Math.max(0,Math.min(1,i.current/i.max)),x=Math.round(d*100);return d>=1?{copy:l.condition.pristine(x),style:fe,color:"rgba(226, 232, 240, 0.86)"}:d<=0?{copy:l.condition.broken,style:De,color:"#f87171"}:d<=.25?{copy:l.condition.critical(x),style:De,color:"#fbbf24"}:d<=.5?{copy:l.condition.worn(x),style:De,color:"#f59e0b"}:{copy:l.condition.used(x),style:fe,color:"rgba(250, 204, 21, 0.95)"}},[l.condition]),A=s.useMemo(()=>{const i=v.equipment.slots;return[{id:"primaryWeapon",badgeColor:K.primaryWeapon,label:i.primaryWeapon.label,emptyCopy:i.primaryWeapon.empty},{id:"secondaryWeapon",badgeColor:K.secondaryWeapon,label:i.secondaryWeapon.label,emptyCopy:i.secondaryWeapon.empty},{id:"meleeWeapon",badgeColor:K.meleeWeapon,label:i.meleeWeapon.label,emptyCopy:i.meleeWeapon.empty},{id:"bodyArmor",badgeColor:K.bodyArmor,label:i.bodyArmor.label,emptyCopy:i.bodyArmor.empty},{id:"helmet",badgeColor:K.helmet,label:i.helmet.label,emptyCopy:i.helmet.empty},{id:"accessory1",badgeColor:K.accessory1,label:i.accessory1.label,emptyCopy:i.accessory1.empty},{id:"accessory2",badgeColor:K.accessory2,label:i.accessory2.label,emptyCopy:i.accessory2.empty}]},[v.equipment.slots]),{knownPerks:j,unknownPerkIds:P}=s.useMemo(()=>{const i=[],d=[];return n.perks.forEach(x=>{try{i.push(lr(x))}catch(T){console.warn("[PlayerLoadoutPanel] Unknown perk id encountered:",x,T),d.push(x)}}),{knownPerks:i,unknownPerkIds:d}},[n.perks]),B=s.useMemo(()=>{const i={primaryWeapon:[],secondaryWeapon:[],meleeWeapon:[],bodyArmor:[],helmet:[],accessory1:[],accessory2:[]};return n.inventory.items.forEach(d=>{const x=dn(d);x&&i[x]&&i[x].push(d)}),i},[n.inventory.items]),R=s.useCallback(i=>{var d;if((d=n.equippedSlots)!=null&&d[i])return n.equippedSlots[i];switch(i){case"primaryWeapon":return n.equipped.weapon;case"secondaryWeapon":return n.equipped.secondaryWeapon;case"meleeWeapon":return n.equipped.meleeWeapon;case"bodyArmor":return n.equipped.bodyArmor??n.equipped.armor;case"helmet":return n.equipped.helmet;case"accessory1":return n.equipped.accessory1;case"accessory2":return n.equipped.accessory2;default:return}},[n.equipped,n.equippedSlots]),E=s.useCallback((i,d)=>{r(Dt({itemId:i,slot:d}))},[r]),h=s.useCallback(i=>{r($t({slot:i}))},[r]),D=()=>e.jsxs("div",{style:mt,children:[e.jsx("div",{style:bt("rgba(236, 72, 153, 0.65)"),children:l.perksLabel}),j.length===0&&P.length===0?e.jsx("span",{style:w,children:l.noPerks}):e.jsxs("div",{style:tn,children:[j.map(i=>e.jsx(At,{content:e.jsx(Rt,{title:i.name,description:i.description,lines:i.effects}),wrapperStyle:{display:"inline-flex"},children:e.jsx("span",{style:ht,children:i.name})},i.id)),P.map(i=>e.jsx("span",{style:ht,children:i},i))]})]}),o=s.useCallback((i,d)=>{var M;if(!d)return[];const x=l.stats;if(pn(d)){const W=[{label:x.damage,value:`${d.damage}`},{label:x.range,value:`${d.range}`},{label:x.apCost,value:`${d.apCost}`}];return d.skillType&&W.push({label:x.skill,value:((M=hr(d.skillType))==null?void 0:M.name)??"—"}),W}if(un(d)){const W=typeof d.protection=="number"?`${d.protection}`:"—";return[{label:x.protection,value:W},{label:x.weight,value:k(d.weight)}]}const T=[{label:x.weight,value:k(d.weight)},{label:x.value,value:`₿${d.value}`}];return T},[k,l.stats]),f=i=>{const{id:d,label:x,badgeColor:T,emptyCopy:M}=i,W=R(d),O=c(W==null?void 0:W.durability),U=o(d,W),ee=B[d],te=d==="bodyArmor"||d==="helmet"?sn:d==="accessory1"||d==="accessory2"?cn:on;return e.jsxs("div",{style:mt,children:[e.jsx("div",{style:bt(T),children:x}),e.jsx("div",{style:en,children:(W==null?void 0:W.name)??M}),W?e.jsxs(e.Fragment,{children:[U.map(q=>e.jsxs("div",{style:fe,children:[e.jsx("span",{style:gt,children:q.label}),e.jsx("span",{style:ft,children:q.value})]},`${d}-${q.label}`)),O&&e.jsxs("div",{style:O.style,children:[e.jsx("span",{style:gt,children:l.stats.durability}),e.jsx("span",{style:{...ft,color:O.color},children:O.copy})]}),W.description&&e.jsx("span",{style:w,children:W.description}),e.jsxs("div",{style:yt,children:[e.jsx("button",{type:"button",style:ln,onClick:()=>h(d),children:l.actions.unequip}),ee.filter(q=>q.id!==W.id).map(q=>e.jsx("button",{type:"button",style:te,onClick:()=>E(q.id,d),children:l.actions.equip(q.name)},q.id))]})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{style:w,children:M}),ee.length>0?e.jsx("div",{style:yt,children:ee.map(q=>e.jsx("button",{type:"button",style:te,onClick:()=>E(q.id,d),children:l.actions.equip(q.name)},q.id))}):e.jsx("span",{style:{...w,fontSize:"0.58rem"},children:l.noCompatible})]})]},d)};return e.jsxs("div",{style:Jr,"data-testid":"player-loadout-panel",role:"region","aria-label":l.ariaLabel,children:[e.jsxs("header",{style:rn,children:[e.jsx("span",{style:nn,children:l.headingLabel}),e.jsx("h3",{style:an,children:l.headingTitle})]}),e.jsxs("div",{style:Xr,children:[e.jsx("div",{style:Zr,children:A.map(f)}),D()]})]})},bn=he.memo(mn),yn={...J,display:"grid",gridTemplateRows:"auto auto minmax(0, 1fr)",gap:"0.75rem",minHeight:0,height:"100%",position:"relative"},gn={display:"flex",alignItems:"center",justifyContent:"space-between",color:z.textSecondary,gap:"0.6rem"},fn={...qe},hn={...H},xn={...oe},Sn={display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"0.14rem",fontSize:"0.62rem",color:z.textMuted},jn={fontSize:"0.55rem",color:"rgba(148, 163, 184, 0.72)"},vn={display:"flex",flexDirection:"column",gap:"0.18rem"},kn={position:"sticky",top:0,zIndex:2,display:"flex",flexDirection:"column",gap:"0.45rem",padding:"0.3rem 0",background:"rgba(15, 23, 42, 0.92)",borderBottom:"1px solid rgba(56, 189, 248, 0.14)"},Cn={display:"flex",flexWrap:"wrap",gap:"0.4rem"},me={borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.25)",padding:"0.22rem 0.65rem",fontSize:"0.58rem",letterSpacing:"0.12em",textTransform:"uppercase",background:"rgba(15, 23, 42, 0.55)",color:"rgba(226, 232, 240, 0.85)",cursor:"pointer",transition:"border-color 0.2s ease, background 0.2s ease, color 0.2s ease"},wn={display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(180px, 1fr))",gap:"0.45rem"},Mn={borderRadius:"12px",border:"1px solid rgba(148, 163, 184, 0.18)",background:"rgba(15, 23, 42, 0.7)",display:"flex",flexDirection:"column",gap:"0.34rem",padding:"0.52rem 0.55rem",color:"#e2e8f0"},In={display:"flex",alignItems:"center",justifyContent:"space-between",gap:"0.3rem"},Tn={fontSize:"0.74rem",fontWeight:700,display:"flex",alignItems:"center",gap:"0.35rem",flexWrap:"wrap"},be=r=>({borderRadius:"6px",padding:"0.15rem 0.35rem",fontSize:"0.54rem",letterSpacing:"0.08em",textTransform:"uppercase",color:r,border:`1px solid ${r}`,background:"rgba(15, 23, 42, 0.65)"}),Wn={...w,display:"flex",flexDirection:"column",gap:"0.22rem",fontSize:"0.6rem"},xt={height:"6px",borderRadius:"999px",background:"rgba(148, 163, 184, 0.2)",overflow:"hidden"},zn={display:"flex",flexWrap:"wrap",gap:"0.3rem",marginTop:"0.15rem"},$={borderRadius:"6px",border:"1px solid rgba(148, 163, 184, 0.25)",padding:"0.25rem 0.45rem",fontSize:"0.58rem",letterSpacing:"0.08em",textTransform:"uppercase",background:"rgba(30, 41, 59, 0.7)",color:z.textSecondary,cursor:"pointer"},Pn={display:"inline-flex",alignItems:"center",justifyContent:"center",padding:"0.18rem 0.4rem",borderRadius:"999px",fontSize:"0.55rem",letterSpacing:"0.08em",textTransform:"uppercase",border:"1px solid rgba(56, 189, 248, 0.5)",color:"#e0f2fe",background:"rgba(37, 99, 235, 0.2)"},Dn={display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(180px, 1fr))",gap:"0.45rem"},$n={borderRadius:"12px",border:"1px solid rgba(148, 163, 184, 0.18)",background:"rgba(9, 16, 32, 0.6)",padding:"0.55rem 0.6rem",display:"flex",flexDirection:"column",gap:"0.35rem"},$e={fontSize:"0.58rem",letterSpacing:"0.12em",textTransform:"uppercase",color:z.textMuted},An={fontSize:"0.7rem",fontWeight:600,color:z.textPrimary},St={display:"flex",flexDirection:"column",gap:"0.4rem"},Rn={display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",gap:"0.4rem"},qn={borderRadius:"10px",border:"1px dashed rgba(148, 163, 184, 0.28)",padding:"0.4rem 0.5rem",background:"rgba(15, 23, 42, 0.5)",display:"flex",flexDirection:"column",gap:"0.25rem",fontSize:"0.6rem",color:z.textSecondary},Ln={...w,padding:"0.6rem 0"},Bn={minHeight:0,display:"flex",flexDirection:"column",gap:"0.7rem",overflowY:"auto",paddingRight:"0.4rem",paddingBottom:"0.6rem",position:"relative"},En={fontSize:"0.58rem",color:z.textMuted},jt=["all","weapons","armor","consumables","quest","misc"],Y={primaryWeapon:"rgba(56, 189, 248, 0.75)",secondaryWeapon:"rgba(59, 130, 246, 0.65)",meleeWeapon:"rgba(251, 191, 36, 0.75)",bodyArmor:"rgba(96, 165, 250, 0.75)",helmet:"rgba(147, 197, 253, 0.75)",accessory1:"rgba(236, 72, 153, 0.65)",accessory2:"rgba(236, 72, 153, 0.65)"},vt={normal:"#34d399",heavy:"#fbbf24",overloaded:"#fb7185",immobile:"#f87171",unknown:z.textSecondary},Fn=2,Q=r=>r.damage!==void 0,Be=r=>r.protection!==void 0,qt=r=>r.effect!==void 0,Ae=r=>!!r.weaponModId,Hn=r=>r.isQuestItem?"quest":Q(r)?"weapons":Be(r)?"armor":qt(r)?"consumables":"misc",kt=r=>{if(r.equipSlot)return r.equipSlot;if(Q(r)){const n=r.range,u=r.skillType;return typeof n=="number"&&n<=1||u==="meleeCombat"?"meleeWeapon":"primaryWeapon"}return Be(r)?"bodyArmor":null},Ct=r=>{if(!r.durability||r.durability.max<=0)return null;const n=r.durability.current/r.durability.max;return Number.isFinite(n)?Math.max(0,Math.min(100,Math.round(n*100))):null},wt=r=>{let n="#34d399";return r<25?n="#f87171":r<50?n="#fbbf24":r<75&&(n="#38bdf8"),{width:`${r}%`,height:"100%",background:n,transition:"width 0.25s ease"}},On=r=>{if(!r.stackable)return 1;const n=r.quantity??1;return!Number.isFinite(n)||n<=0?1:Math.floor(n)},Nn=r=>r?r.modSlots&&r.modSlots.length>=0?r.modSlots:(r.weaponType??(r.range<=1?"melee":"pistol"))==="melee"?[]:["barrel","magazine","optics"]:[],_n=r=>r?r.weaponType??(r.range<=1?"melee":"pistol"):"pistol",Mt=r=>{var l,v;const n=Re(r),{effect:u}=n,m=[];if(u.hitChanceBonus&&m.push(`+${Math.round(u.hitChanceBonus*100)}% accuracy`),u.hitChancePenalty&&m.push(`-${Math.round(u.hitChancePenalty*100)}% accuracy`),u.damageMultiplier&&u.damageMultiplier!==1){const g=Math.round((u.damageMultiplier-1)*100),k=g>=0?"+":"";m.push(`${k}${g}% damage`)}if(u.magazineSizeMultiplier&&u.magazineSizeMultiplier!==1){const g=Math.round((u.magazineSizeMultiplier-1)*100);m.push(`+${g}% magazine`)}return u.critChanceBonus&&m.push(`+${u.critChanceBonus}% crit`),(u.silenced||(l=u.addTags)!=null&&l.includes("silenced"))&&m.push("Silences shots"),(u.armorPiercingFactor!==void 0||(v=u.addTags)!=null&&v.includes("armorPiercing"))&&m.push("Ignores 50% armor"),m.length>0?m.join(" • "):"No stat changes"},Un=(r,n,u)=>`${r}: ${n}/${u}`,Vn=()=>{var Ge;const r=xe(),n=L(t=>t.player.data),u=L(t=>t.settings.locale),m=L(t=>!!t.settings.reputationSystemsEnabled),l=L(t=>t.world.workbenchStatus),v=L(t=>t.world.workbenchAvailable),g=(l==null?void 0:l.available)??v,k=Z(u),c=k.inventoryPanel,A=k.playerStatus.loadUnit,j=(l==null?void 0:l.feeRequired)??0,P=l==null?void 0:l.locationName,B=l==null?void 0:l.note,R=s.useCallback(t=>`${(Number.isFinite(t)?Math.round(t*10)/10:0).toFixed(1)} ${A}`,[A]),[E,h]=s.useState("all"),[D,o]=s.useState(null),[f,i]=s.useState({}),[d,x]=s.useState(!1),[T,M]=s.useState(null),W=s.useCallback(()=>{o(null),x(!0)},[]),O=s.useCallback(()=>{x(!1)},[]),U=s.useMemo(()=>n.inventory.items.map(t=>({item:t,category:Hn(t),condition:Ct(t)})),[n.inventory.items]),ee=s.useMemo(()=>{const t=jt.reduce((a,b)=>(a[b]=0,a),{});return U.forEach(a=>{t.all+=1,t[a.category]+=1}),t},[U]),te=s.useMemo(()=>U.filter(t=>E==="all"||t.category===E),[U,E]),q=s.useMemo(()=>[...te].sort((t,a)=>t.item.name.localeCompare(a.item.name,void 0,{sensitivity:"base"})),[te]),re=s.useMemo(()=>{const t=n.encumbrance.level??"unknown",a=["normal","heavy","overloaded","immobile"].includes(t)?t:"unknown",b=c.encumbranceDescriptors[a]??c.encumbranceDescriptors.unknown;let p;a==="heavy"?p=c.encumbranceSummary.heavy(n.encumbrance.movementApMultiplier,n.encumbrance.attackApMultiplier):a==="overloaded"?p=c.encumbranceSummary.overloaded(n.encumbrance.movementApMultiplier,n.encumbrance.attackApMultiplier):a==="immobile"?p=c.encumbranceSummary.immobile:a==="normal"?p=c.encumbranceSummary.normal:p=c.encumbranceSummary.unknown;const S=c.encumbranceWarning[a],I=vt[a]??vt.unknown;return{label:b,summary:p,warning:S,color:I}},[c,n.encumbrance]),je=s.useMemo(()=>{const t=c.equipment.slots;return[{id:"primaryWeapon",badgeColor:Y.primaryWeapon,label:t.primaryWeapon.label,description:t.primaryWeapon.description,emptyCopy:t.primaryWeapon.empty},{id:"secondaryWeapon",badgeColor:Y.secondaryWeapon,label:t.secondaryWeapon.label,description:t.secondaryWeapon.description,emptyCopy:t.secondaryWeapon.empty},{id:"meleeWeapon",badgeColor:Y.meleeWeapon,label:t.meleeWeapon.label,description:t.meleeWeapon.description,emptyCopy:t.meleeWeapon.empty},{id:"bodyArmor",badgeColor:Y.bodyArmor,label:t.bodyArmor.label,description:t.bodyArmor.description,emptyCopy:t.bodyArmor.empty},{id:"helmet",badgeColor:Y.helmet,label:t.helmet.label,description:t.helmet.description,emptyCopy:t.helmet.empty},{id:"accessory1",badgeColor:Y.accessory1,label:t.accessory1.label,description:t.accessory1.description,emptyCopy:t.accessory1.empty},{id:"accessory2",badgeColor:Y.accessory2,label:t.accessory2.label,description:t.accessory2.description,emptyCopy:t.accessory2.empty}]},[c.equipment.slots]),N=s.useMemo(()=>{const t=n.inventory.hotbar??[];return t.length===0?[null,null,null,null,null]:t},[n.inventory.hotbar]),Bt=N.filter(Boolean).length,Et=s.useMemo(()=>N.every(t=>t!==null),[N]),Ee=s.useCallback(t=>{if(!t)return;const a=n.inventory.items.find(p=>p.id===t);if(a&&Q(a))return a;const b=Object.values(n.equipped).find(p=>p&&p.id===t);if(b&&Q(b))return b},[n.equipped,n.inventory.items]),y=s.useMemo(()=>Ee(D),[Ee,D]),V=s.useMemo(()=>Nn(y),[y]),F=s.useMemo(()=>n.inventory.items.filter(t=>Ae(t)),[n.inventory.items]),Fe=s.useMemo(()=>{var t;return((t=n.skillTraining)==null?void 0:t.engineering)??0},[(Ge=n.skillTraining)==null?void 0:Ge.engineering]),He=s.useCallback(t=>n.inventory.items.reduce((a,b)=>{if(b.definitionId!==t)return a;const p=b.stackable?b.quantity??1:1;return a+p},0),[n.inventory.items]),Ft=s.useMemo(()=>ir(),[]),X=s.useMemo(()=>{const t={};return((y==null?void 0:y.attachedMods)??[]).forEach(a=>{t[a.slot]=a}),t},[y==null?void 0:y.attachedMods]),ve=s.useMemo(()=>Je(y),[y]),Oe=s.useMemo(()=>{if(!y)return[];const t=[];return V.forEach(a=>{const b=f[a];if(b!==null){if(b){t.push({slot:a,modId:b.modId});return}X[a]&&t.push({slot:a,modId:X[a].modId})}}),t},[V,y,f,X]),ne=s.useMemo(()=>Je(y,Oe),[y,Oe]);s.useEffect(()=>{if(!y){i({}),M(null);return}const t={};(y.attachedMods??[]).forEach(a=>{t[a.slot]={modId:a.modId}}),i(t)},[y]);const Ne=(y==null?void 0:y.damage)??0,_e=(y==null?void 0:y.accuracy)??.65,se=(y==null?void 0:y.magazineSize)??0,ke=Math.round(Ne*(ve.damageMultiplier??1)),Ce=Math.round(Ne*(ne.damageMultiplier??1)),we=Math.max(0,Math.min(.99,_e+ve.hitChanceBonus)),Me=Math.max(0,Math.min(.99,_e+ne.hitChanceBonus)),ce=se>0?Math.max(1,Math.round(se*(ve.magazineSizeMultiplier??1))):0,de=se>0?Math.max(1,Math.round(se*(ne.magazineSizeMultiplier??1))):0,Ht=s.useCallback(t=>{const a=kt(t);a&&r(Dt({itemId:t.id,slot:a}))},[r]),Ot=s.useCallback(t=>{if(!t.durability)return;const a=Math.max(0,t.durability.max-t.durability.current);a<=0||r(xr({itemId:t.id,amount:a}))},[r]),Nt=s.useCallback(t=>{r(Sr(t.id))},[r]),_t=s.useCallback(t=>{const a=N.findIndex(p=>p===t.id);if(a!==-1){r(We({slotIndex:a,itemId:null}));return}const b=N.findIndex(p=>p===null);b!==-1&&r(We({slotIndex:b,itemId:t.id}))},[r,N]),Ie=s.useCallback(t=>{if(n.equippedSlots&&n.equippedSlots[t])return n.equippedSlots[t];switch(t){case"primaryWeapon":return n.equipped.weapon;case"secondaryWeapon":return n.equipped.secondaryWeapon;case"meleeWeapon":return n.equipped.meleeWeapon;case"bodyArmor":return n.equipped.bodyArmor??n.equipped.armor;case"helmet":return n.equipped.helmet;case"accessory1":return n.equipped.accessory1;case"accessory2":return n.equipped.accessory2;default:return}},[n.equipped,n.equippedSlots]),Ut=s.useCallback(t=>{h("all"),r($t({slot:t}))},[r]),pe=s.useCallback(t=>{M(null),o(t)},[]),Ue=s.useCallback(()=>{M(null),o(null)},[]),ae=s.useCallback((t,a)=>{if(a==="__keep__"){i(p=>{const S={...p};return delete S[t],S}),M(null);return}if(a===""){i(p=>({...p,[t]:null})),M(null);return}const b=F.find(p=>p.id===a&&p.weaponModId);!b||!b.weaponModId||(i(p=>{const S={...p};return Object.entries(S).forEach(([I,G])=>{I!==t&&G&&G.modItemId===a&&delete S[I]}),S[t]={modId:b.weaponModId,modItemId:b.id},S}),M(null))},[F]),Vt=s.useCallback(t=>{y&&(i(a=>({...a,[t]:null})),M(null),r(Xe({weaponId:y.id,slot:t})))},[r,y]),Gt=s.useCallback((t,a)=>{a.weaponModId&&(t.dataTransfer.setData("application/weapon-mod-item",a.id),t.dataTransfer.setData("text/plain",a.name),M(null))},[]),Kt=s.useCallback((t,a)=>{if(!y)return;const b=t.dataTransfer.getData("application/weapon-mod-item");if(!b)return;const p=F.find(I=>I.id===b);if(!(p!=null&&p.weaponModId))return;if(t.preventDefault(),!Ze(y,p.weaponModId,a).compatible){t.dataTransfer.dropEffect="none";return}t.dataTransfer.dropEffect="copy"},[F,y]),Yt=s.useCallback((t,a)=>{if(!y)return;t.preventDefault();const b=t.dataTransfer.getData("application/weapon-mod-item");if(!b)return;const p=F.find(I=>I.id===b);if(!(p!=null&&p.weaponModId))return;const S=Ze(y,p.weaponModId,a);if(!S.compatible){M(S.reason??"This mod is not compatible with the selected slot/weapon.");return}M(null),ae(a,b)},[F,ae,y]),Qt=s.useCallback(()=>{y&&(V.forEach(t=>{var S;const a=f[t],b=X[t];if(a===void 0)return;if(a===null){b&&r(Xe({weaponId:y.id,slot:t}));return}if(b&&b.modId===a.modId)return;const p=a.modItemId??((S=F.find(I=>I.weaponModId===a.modId))==null?void 0:S.id);p&&r(jr({weaponId:y.id,modItemId:p}))}),M(null),o(null))},[V,f,X,r,y,F]),Jt=s.useCallback(t=>{const a=j>0?j:void 0;r(vr({modId:t,atWorkbench:g,feePaid:a})),a&&M(`Paid ${a} credits for market workbench access.`)},[g,r,j]),Ve=s.useMemo(()=>je.map(t=>Ie(t.id)).filter(Boolean),[Ie,je]),Te=s.useMemo(()=>Ve.reduce((t,a)=>t+(Number.isFinite(a.weight)?a.weight:0),0),[Ve]),Xt=s.useMemo(()=>n.inventory.currentWeight+Te,[n.inventory.currentWeight,Te]);return e.jsxs("div",{style:yn,"data-testid":"player-inventory-panel",role:"region","aria-label":c.title,children:[d&&e.jsxs("div",{style:{position:"absolute",inset:"0.25rem",background:"rgba(15, 23, 42, 0.96)",border:"1px solid rgba(56, 189, 248, 0.35)",borderRadius:"12px",padding:"0.9rem",display:"flex",flexDirection:"column",gap:"0.7rem",zIndex:6},role:"dialog","aria-modal":"true","aria-label":"Workbench Crafting Panel",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.22rem"},children:[e.jsx("span",{style:{...H,letterSpacing:"0.14em"},children:"Weapon Mods"}),e.jsx("strong",{style:{...oe,fontSize:"1rem"},children:"Workbench Crafting"}),e.jsx("span",{style:{...w,fontSize:"0.66rem",color:g?"#34d399":"#fbbf24"},children:g?`Workbench ready${P?` @ ${P}`:""}`:"No workbench in range"}),j>0&&e.jsx("span",{style:{...w,fontSize:"0.62rem",color:"#fbbf24"},children:m?`Market access fee: ${j} credits if Scavenger rep < Friendly`:`Market access fee: ${j} credits`}),B&&e.jsx("span",{style:{...w,fontSize:"0.62rem",color:"#fbbf24"},children:B})]}),e.jsx("button",{type:"button",onClick:O,style:{...$,padding:"0.3rem 0.65rem"},children:"Close"})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(260px, 1fr))",gap:"0.65rem"},children:Ft.map(t=>{const a=Fe>=t.crafting.level,b=t.crafting.inputs.every(S=>He(S.id)>=S.quantity),p=g&&a&&b;return e.jsxs("div",{style:{border:"1px solid rgba(148, 163, 184, 0.2)",borderRadius:"10px",padding:"0.65rem",background:"rgba(15, 23, 42, 0.78)",display:"flex",flexDirection:"column",gap:"0.35rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.14rem"},children:[e.jsx("span",{style:{fontSize:"0.78rem",color:z.textPrimary},children:t.name}),e.jsxs("span",{style:{...w,fontSize:"0.6rem"},children:["Slot: ",t.slot," • ",Mt(t.id)]})]}),e.jsx("button",{type:"button",style:{...$,padding:"0.24rem 0.55rem",borderColor:p?"#34d399":"#64748b",color:p?"#bbf7d0":"#cbd5e1",opacity:p?1:.6,cursor:p?"pointer":"not-allowed"},disabled:!p,onClick:()=>Jt(t.id),children:"Craft"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.2rem"},children:[e.jsxs("span",{style:{...w,fontSize:"0.62rem"},children:["Workbench required • Engineering ",t.crafting.level]}),e.jsxs("span",{style:{fontSize:"0.62rem",color:a?"#bbf7d0":"#fbbf24"},children:["Engineering: ",Fe,"/",t.crafting.level]})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.22rem"},children:t.crafting.inputs.map(S=>{const I=He(S.id),G=I>=S.quantity;return e.jsx("span",{style:{...w,fontSize:"0.62rem",color:G?"#bbf7d0":"#fbbf24"},children:Un(S.id.replace("resource_","").replace("_"," "),I,S.quantity)},S.id)})})]},t.id)})})]}),y&&e.jsxs("div",{style:{position:"absolute",inset:"0.25rem",background:"rgba(15, 23, 42, 0.92)",border:"1px solid rgba(56, 189, 248, 0.35)",borderRadius:"12px",padding:"0.8rem",display:"flex",flexDirection:"column",gap:"0.7rem",zIndex:5},role:"dialog","aria-modal":"true","aria-label":"Weapon Modification Panel",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.2rem"},children:[e.jsx("span",{style:{...H,letterSpacing:"0.14em"},children:"Modify Weapon"}),e.jsx("strong",{style:{...oe,fontSize:"0.95rem"},children:y.name}),e.jsxs("span",{style:{...w,fontSize:"0.66rem"},children:["Slots: ",V.length>0?V.join(", "):"None"]})]}),e.jsx("button",{type:"button",onClick:Ue,style:{...$,padding:"0.28rem 0.55rem"},children:"Close"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:"0.6rem"},children:[T&&e.jsx("div",{style:{gridColumn:"1 / -1",padding:"0.45rem 0.6rem",borderRadius:"8px",border:"1px solid rgba(248, 113, 113, 0.35)",background:"rgba(127, 29, 29, 0.35)",color:"#fecaca",fontSize:"0.64rem"},children:T}),V.map(t=>{const a=_n(y),b=X[t],p=f[t],S=new Set(Object.entries(f).filter(([C])=>C!==t).map(([,C])=>C==null?void 0:C.modItemId).filter(Boolean)),I=F.filter(C=>{if(!C.weaponModId)return!1;const _=Re(C.weaponModId);return!(_.slot!==t||!_.compatibleWeaponTypes.includes(a)||S.has(C.id))}),G=b?Re(b.modId).name:"Empty";return e.jsxs("div",{style:{border:"1px solid rgba(148, 163, 184, 0.2)",borderRadius:"10px",padding:"0.55rem",background:"rgba(15, 23, 42, 0.7)",display:"flex",flexDirection:"column",gap:"0.35rem"},onDragOver:C=>Kt(C,t),onDrop:C=>Yt(C,t),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("span",{style:{fontSize:"0.72rem",color:z.textPrimary,textTransform:"capitalize"},children:[t," slot"]}),e.jsx("button",{type:"button",style:{...$,padding:"0.2rem 0.5rem"},onClick:()=>Vt(t),disabled:!b,children:"Detach"})]}),e.jsxs("span",{style:{...w,fontSize:"0.62rem"},children:["Current: ",G]}),e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.35rem"},role:"listbox","aria-label":`${t} slot mods`,children:[e.jsx("button",{type:"button",style:{...$,padding:"0.24rem 0.55rem",borderColor:p===void 0?"#38bdf8":"rgba(148, 163, 184, 0.25)",color:p===void 0?"#e0f2fe":w.color},onClick:()=>ae(t,"__keep__"),children:"Keep current"}),e.jsx("button",{type:"button",style:{...$,padding:"0.24rem 0.55rem",borderColor:p===null?"#38bdf8":"rgba(148, 163, 184, 0.25)",color:p===null?"#e0f2fe":w.color},onClick:()=>ae(t,""),children:"Empty slot"}),I.map(C=>{const _=(p==null?void 0:p.modItemId)===C.id||(p==null?void 0:p.modId)===C.weaponModId;return e.jsx("button",{type:"button",style:{...$,padding:"0.24rem 0.55rem",borderColor:_?"#38bdf8":"rgba(56, 189, 248, 0.35)",color:"#e0f2fe",background:_?"rgba(14, 165, 233, 0.18)":$.background},onClick:()=>ae(t,C.id),children:C.name},`${t}-${C.id}`)})]}),I.length>0&&e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.15rem"},children:I.map(C=>e.jsxs("span",{style:{...w,fontSize:"0.6rem"},children:[C.name,": ",Mt(C.weaponModId)]},`summary-${t}-${C.id}`))}),I.length===0&&e.jsx("span",{style:{...w,fontSize:"0.6rem",color:"#fbbf24"},children:"No compatible mods in inventory for this slot/weapon type. Craft one at a workbench."})]},t)})]}),e.jsxs("div",{style:{border:"1px solid rgba(56, 189, 248, 0.3)",borderRadius:"10px",padding:"0.6rem",background:"rgba(8, 47, 73, 0.35)",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:"0.5rem"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.2rem"},children:[e.jsx("span",{style:{...H,letterSpacing:"0.12em"},children:"Damage"}),e.jsxs("span",{style:{fontSize:"0.86rem",color:z.textPrimary},children:[ke," →"," ",e.jsx("span",{style:{color:Ce>ke?"#34d399":Ce<ke?"#f87171":z.textPrimary},children:Ce})]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.2rem"},children:[e.jsx("span",{style:{...H,letterSpacing:"0.12em"},children:"Accuracy"}),e.jsxs("span",{style:{fontSize:"0.86rem",color:z.textPrimary},children:[(we*100).toFixed(0),"% →"," ",e.jsxs("span",{style:{color:Me>we?"#34d399":Me<we?"#f87171":z.textPrimary},children:[(Me*100).toFixed(0),"%"]})]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.2rem"},children:[e.jsx("span",{style:{...H,letterSpacing:"0.12em"},children:"Magazine"}),e.jsxs("span",{style:{fontSize:"0.86rem",color:z.textPrimary},children:[ce>0?ce:"—"," →"," ",e.jsx("span",{style:{color:de>ce?"#34d399":de<ce?"#f87171":z.textPrimary},children:de>0?de:"—"})]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.2rem"},children:[e.jsx("span",{style:{...H,letterSpacing:"0.12em"},children:"Special"}),e.jsxs("span",{style:{fontSize:"0.76rem",color:z.textSecondary},children:[ne.silenced?"Silenced shots":"Loud shots"," • ",ne.armorPiercingFactor!==void 0?"Armor-piercing":"Standard rounds"]})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"0.5rem"},children:[e.jsx("button",{type:"button",style:{...$,padding:"0.32rem 0.7rem"},onClick:Ue,children:"Cancel"}),e.jsx("button",{type:"button",style:{...$,padding:"0.32rem 0.7rem",borderColor:"#34d399",color:"#bbf7d0"},onClick:Qt,children:"Apply"})]})]}),e.jsxs("header",{style:gn,children:[e.jsxs("div",{style:fn,children:[e.jsx("span",{style:hn,children:k.loadoutPanel.headingLabel}),e.jsx("h3",{style:xn,children:c.title})]}),e.jsxs("div",{style:Sn,children:[e.jsx("span",{children:c.weightTitle}),e.jsx("strong",{style:{fontSize:"0.74rem",color:z.textPrimary},children:`${R(Xt)} / ${R(n.inventory.maxWeight)}`}),e.jsx("span",{style:jn,children:c.summary(R(n.inventory.currentWeight),R(Te))})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",alignItems:"center",gap:"0.4rem"},children:[e.jsx("button",{type:"button",style:{...$,padding:"0.25rem 0.65rem",borderColor:g?"#34d399":"#64748b",color:g?"#bbf7d0":"#cbd5e1",opacity:g?1:.6,cursor:g?"pointer":"not-allowed"},disabled:!g,onClick:W,children:"Use Workbench"}),e.jsx("span",{style:{...w,fontSize:"0.62rem"},children:g?`Workbench in range${P?` (${P})`:""}`:B??"Find a workbench to craft mods"}),j>0&&e.jsx("span",{style:{...w,fontSize:"0.6rem",color:"#fbbf24"},children:m?`Fee: ${j} credits if Scavenger reputation < Friendly`:`Fee: ${j} credits`})]}),e.jsxs("div",{style:vn,children:[e.jsxs("span",{style:{fontSize:"0.64rem",color:re.color},children:[re.label," (",n.encumbrance.percentage.toFixed(1),"%)"]}),e.jsx("span",{style:{...w,fontSize:"0.6rem"},children:re.summary}),re.warning&&e.jsx("span",{style:{fontSize:"0.58rem",color:"#fbbf24"},children:re.warning})]}),e.jsxs("div",{style:Bn,children:[e.jsxs("div",{style:kn,children:[e.jsx("div",{style:Cn,role:"group","aria-label":c.filtersAriaLabel,children:jt.map(t=>{const a=E===t;return e.jsxs("button",{type:"button",style:{...me,border:a?"1px solid rgba(56, 189, 248, 0.65)":me.border,background:a?"rgba(37, 99, 235, 0.2)":me.background,color:a?"#e0f2fe":me.color},"aria-pressed":a,onClick:()=>h(t),children:[c.filters[t],e.jsx("span",{style:{marginLeft:"0.35rem",color:"rgba(148, 163, 184, 0.75)"},children:ee[t]??0})]},t)})}),e.jsx("span",{style:En,children:c.showingCount(q.length,U.length)})]}),q.length===0?e.jsx("span",{style:Ln,children:c.emptyState}):e.jsx("div",{style:wn,role:"list","aria-label":c.itemsAriaLabel,children:q.map(({item:t,condition:a})=>{const b=On(t),p=!!kt(t),S=qt(t),I=t.durability&&t.durability.current<t.durability.max,C=(I&&t.durability?t.durability.max-t.durability.current:0)*Fn,_=N.findIndex(ie=>ie===t.id),le=_!==-1,ue=!le&&Et,Zt=le?c.actions.removeFromHotbar:ue?c.actions.hotbarFull:c.actions.addToHotbar,er=c.hotbarBadge(_+1),Ke=R(t.weight),Ye=Q(t);return e.jsxs("div",{style:Mn,role:"listitem","aria-label":t.name,draggable:Ae(t),onDragStart:ie=>{Ae(t)&&Gt(ie,t)},onContextMenu:ie=>{Ye&&(ie.preventDefault(),pe(t.id))},children:[e.jsxs("div",{style:In,children:[e.jsxs("div",{style:Tn,children:[e.jsx("span",{children:t.name}),b>1&&e.jsxs("span",{style:{fontSize:"0.62rem",color:z.textMuted},children:["×",b]}),le&&e.jsx("span",{style:Pn,children:er})]}),e.jsxs("div",{style:{display:"flex",gap:"0.3rem",flexWrap:"wrap"},children:[t.isQuestItem&&e.jsx("span",{style:be("#fbbf24"),children:c.badges.quest}),Q(t)&&e.jsx("span",{style:be("#38bdf8"),children:c.badges.weapon}),Be(t)&&e.jsx("span",{style:be("#a855f7"),children:c.badges.armor}),S&&e.jsx("span",{style:be("#34d399"),children:c.badges.consumable})]})]}),e.jsxs("div",{style:Wn,children:[e.jsx("span",{children:t.description}),e.jsx("span",{"aria-label":c.itemWeightAria(Ke,t.value),children:c.weightValue(Ke,t.value)})]}),t.durability&&e.jsxs("div",{children:[e.jsx("div",{style:{...w,fontSize:"0.58rem",marginBottom:"0.22rem"},children:c.durabilityLabel(t.durability.current,t.durability.max)}),e.jsx("div",{style:xt,"aria-hidden":"true",children:e.jsx("div",{style:wt(a??0)})})]}),e.jsxs("div",{style:zn,children:[p&&e.jsx("button",{type:"button",style:$,onClick:()=>Ht(t),children:c.actions.equip}),I&&e.jsx("button",{type:"button",style:{...$,borderColor:"#fbbf24",color:"#fde68a"},onClick:()=>Ot(t),"aria-label":c.actions.repairAria(t.name,C),children:c.actions.repair(C)}),S&&e.jsx("button",{type:"button",style:{...$,borderColor:"#34d399",color:"#bbf7d0"},onClick:()=>Nt(t),children:c.actions.use}),Ye&&e.jsx("button",{type:"button",style:{...$,borderColor:"#38bdf8",color:"#e0f2fe"},onClick:()=>pe(t.id),children:"Modify"}),e.jsx("button",{type:"button",style:{...$,borderColor:le?"rgba(248, 113, 113, 0.55)":"#34d399",color:le?"#fecaca":"#bbf7d0",opacity:ue?.6:1,cursor:ue?"not-allowed":"pointer"},onClick:()=>_t(t),disabled:ue,children:Zt})]})]},t.id)})}),e.jsxs("section",{style:St,"aria-label":c.equippedAriaLabel,children:[e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"0.4rem"},children:e.jsx("span",{style:$e,children:c.equipment.title})}),e.jsx("div",{style:Dn,children:je.map(t=>{const a=Ie(t.id),b=a?Ct(a):null,p=(a==null?void 0:a.durability)&&b!==null,S=a&&Q(a);return e.jsxs("div",{style:$n,onContextMenu:I=>{S&&a&&(I.preventDefault(),pe(a.id))},children:[e.jsx("span",{style:$e,children:t.label}),e.jsx("div",{style:An,children:(a==null?void 0:a.name)??t.emptyCopy}),e.jsx("span",{style:{...w,fontSize:"0.58rem"},children:t.description}),p&&e.jsxs("div",{children:[e.jsx("div",{style:{...w,fontSize:"0.56rem",marginBottom:"0.2rem"},children:c.conditionLabel(b??0)}),e.jsx("div",{style:xt,"aria-hidden":"true",children:e.jsx("div",{style:wt(b??0)})})]}),a&&e.jsxs("div",{style:{display:"flex",gap:"0.3rem",flexWrap:"wrap"},children:[e.jsx("button",{type:"button",style:{...$,alignSelf:"flex-start"},onClick:()=>Ut(t.id),children:c.actions.unequip}),S&&e.jsx("button",{type:"button",style:{...$,alignSelf:"flex-start",borderColor:"#38bdf8",color:"#e0f2fe"},onClick:()=>pe(a.id),children:"Modify"})]})]},t.id)})})]}),e.jsxs("section",{style:St,"aria-label":c.hotbarAriaLabel,children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.4rem"},children:[e.jsx("span",{style:$e,children:c.hotbar.title}),e.jsx(Le,{count:Bt,color:"#34d399",size:18,pulse:!1})]}),e.jsx("div",{style:Rn,children:N.map((t,a)=>{const b=n.inventory.items.find(p=>p.id===t);return e.jsxs("div",{style:qn,children:[e.jsx("span",{style:{fontSize:"0.58rem",color:z.textMuted},children:c.hotbar.slotLabel(a+1)}),e.jsx("span",{style:{fontSize:"0.64rem",color:z.textPrimary},children:(b==null?void 0:b.name)??c.hotbar.unassigned}),e.jsx("button",{type:"button",style:{...$,alignSelf:"flex-start",padding:"0.18rem 0.4rem"},onClick:()=>r(We({slotIndex:a,itemId:null})),disabled:!t,children:c.actions.clearHotbar})]},a)})})]})]})]})},Gn=he.memo(Vn),Kn=({color:r="#38bdf8",size:n=16,thickness:u=2,glow:m=!0})=>{const l=(k,c,A,j,P)=>({position:"absolute",width:`${n}px`,height:`${n}px`,top:c,right:A,bottom:j,left:P,pointerEvents:"none",transform:`rotate(${k}deg)`,zIndex:10}),v=k=>({position:"absolute",background:r,boxShadow:m?`0 0 8px ${r}, 0 0 4px ${r}`:"none",...k?{width:`${u}px`,height:"100%",left:0,top:0}:{height:`${u}px`,width:"100%",left:0,top:0}}),g=({rotation:k,top:c,right:A,bottom:j,left:P})=>e.jsxs("div",{style:l(k,c,A,j,P),children:[e.jsx("div",{style:v(!0)}),e.jsx("div",{style:v(!1)})]});return e.jsxs(e.Fragment,{children:[e.jsx(g,{rotation:0,top:0,left:0}),e.jsx(g,{rotation:90,top:0,right:0}),e.jsx(g,{rotation:180,bottom:0,right:0}),e.jsx(g,{rotation:270,bottom:0,left:0})]})},It=({opacity:r=.03,lineHeight:n=2})=>e.jsx("div",{style:{position:"absolute",inset:0,pointerEvents:"none",background:`repeating-linear-gradient(
          0deg,
          rgba(0, 0, 0, ${r}) 0px,
          transparent ${n}px,
          transparent ${n*2}px,
          rgba(0, 0, 0, ${r}) ${n*2}px
        )`,zIndex:5,borderRadius:"inherit"}}),Yn={...J,display:"flex",flexDirection:"column",gap:"0.7rem",padding:"0.8rem",minHeight:0},Qn={fontSize:"0.72rem",letterSpacing:"0.18em",textTransform:"uppercase",color:"rgba(226, 232, 240, 0.78)"},Jn={display:"flex",flexDirection:"column",gap:"0.6rem",overflow:"auto"},Xn={background:"rgba(15, 23, 42, 0.35)",border:"1px solid rgba(148, 163, 184, 0.16)",borderRadius:"10px",padding:"0.6rem 0.7rem",display:"flex",flexDirection:"column",gap:"0.45rem"},Zn={display:"flex",alignItems:"center",justifyContent:"space-between",gap:"0.6rem"},ea={display:"flex",flexDirection:"column",gap:"0.18rem"},ta={fontSize:"0.74rem",fontWeight:600,color:z.textPrimary,letterSpacing:"0.08em"},ra=r=>({display:"inline-flex",alignItems:"center",gap:"0.2rem",borderRadius:"999px",padding:"0.18rem 0.5rem",fontSize:"0.58rem",letterSpacing:"0.12em",textTransform:"uppercase",color:"rgba(15, 23, 42, 0.95)",background:r}),Tt={fontSize:"0.62rem",letterSpacing:"0.08em",color:"rgba(148, 163, 184, 0.85)"},na={position:"relative",width:"100%",height:"0.35rem",borderRadius:"999px",background:"rgba(71, 85, 105, 0.35)",overflow:"hidden"},aa=(r,n)=>({position:"absolute",inset:0,width:`${Math.max(0,Math.min(100,r))}%`,background:n,borderRadius:"999px",transition:"width 0.4s ease"}),la={display:"flex",flexDirection:"column",gap:"0.25rem",color:"rgba(203, 213, 225, 0.9)",fontSize:"0.6rem",lineHeight:1.35},ia={display:"flex",alignItems:"flex-start",gap:"0.35rem"},oa="•",sa=r=>(Math.max(-100,Math.min(100,r))+100)/200*100,ca=()=>{const r=L(l=>l.settings.locale),n=L(l=>!!l.settings.reputationSystemsEnabled),u=s.useMemo(()=>Z(r),[r]),m=L(nr);return!n||!m.length?null:e.jsxs("section",{style:Yn,"aria-label":u.factionPanel.ariaLabel,children:[e.jsx("h2",{style:Qn,children:u.factionPanel.heading}),e.jsx("div",{style:Jn,role:"list",children:m.map(l=>{const v=et(r,l.standingId),g=sa(l.value),k=l.nextThreshold?et(r,l.nextThreshold.standing.id):null,c=l.nextThreshold&&k?u.factionPanel.nextThreshold(k,l.nextThreshold.requiredValue):u.factionPanel.maxStanding;return e.jsxs("article",{style:Xn,role:"listitem","aria-label":`${l.name} ${v}`,children:[e.jsxs("div",{style:Zn,children:[e.jsxs("div",{style:ea,children:[e.jsx("span",{style:ta,children:l.name}),e.jsxs("span",{style:Tt,children:[u.factionPanel.reputationLabel,": ",l.value]})]}),e.jsxs("span",{style:ra(l.color),children:[l.icon,v]})]}),e.jsx("div",{style:na,children:e.jsx("div",{style:aa(g,l.color),role:"presentation"})}),e.jsxs("div",{style:Tt,children:[u.factionPanel.standingLabel,": ",v," • ",c]}),e.jsxs("div",{style:la,children:[e.jsx("span",{style:{fontWeight:600,letterSpacing:"0.08em",textTransform:"uppercase"},children:u.factionPanel.effectsLabel}),l.effects.length===0?e.jsx("span",{children:u.factionPanel.noEffects}):l.effects.map((A,j)=>e.jsxs("div",{style:ia,children:[e.jsx("span",{"aria-hidden":"true",children:oa}),e.jsx("span",{children:A})]},`${l.factionId}-effect-${j}`))]})]},l.factionId)})})]})},da=he.memo(ca),pa={position:"fixed",inset:0,background:"radial-gradient(circle at top, rgba(15, 23, 42, 0.95), rgba(2, 6, 23, 0.9))",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e4,padding:"2vh 3vw"},ua={position:"relative",width:"min(1400px, 95%)",height:"min(900px, 92vh)",maxHeight:"92vh",background:"linear-gradient(160deg, rgba(15, 23, 42, 0.98), rgba(8, 14, 30, 0.92))",borderRadius:"18px",border:"1px solid rgba(56, 189, 248, 0.25)",boxShadow:"0 40px 80px rgba(2, 6, 23, 0.65)",display:"flex",flexDirection:"column",overflow:"hidden"},ma={padding:"1.2rem 1.5rem",borderBottom:"1px solid rgba(56, 189, 248, 0.18)",display:"flex",alignItems:"center",justifyContent:"space-between",color:"#e2e8f0"},ba={display:"flex",alignItems:"center",gap:"0.6rem"},ya={display:"flex",flexDirection:"column",gap:"0.3rem"},ga={fontSize:"1.35rem",fontWeight:700,letterSpacing:"0.12em",textTransform:"uppercase",background:"linear-gradient(135deg, #bfdbfe, #38bdf8)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",filter:"drop-shadow(0 0 12px rgba(56, 189, 248, 0.5))"},fa={fontSize:"0.8rem",color:"rgba(148, 163, 184, 0.85)"},ha={border:"1px solid rgba(148, 163, 184, 0.4)",background:"rgba(15, 23, 42, 0.6)",color:"#f8fafc",padding:"0.5rem 0.9rem",borderRadius:"999px",fontSize:"0.75rem",letterSpacing:"0.16em",textTransform:"uppercase",cursor:"pointer",transition:"all 0.2s ease"},Lt="minmax(320px, 0.85fr) minmax(0, 1.35fr)",xa={flex:1,display:"grid",gridTemplateColumns:Lt,gap:"1rem",padding:"1.2rem",minHeight:0,height:"100%",overflow:"hidden"},Sa={display:"flex",flexDirection:"column",gap:"0.8rem",minHeight:0,height:"100%",overflow:"hidden"},ja={display:"flex",flexDirection:"column",gap:"0.8rem",minHeight:0,height:"100%",flex:1},va={...J,display:"flex",flexDirection:"column",padding:"0.6rem",gap:"0.8rem",minHeight:0,height:"100%",flex:1},ka={display:"flex",gap:"0.5rem",alignItems:"center",flexWrap:"wrap"},Ca={borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:"rgba(15, 23, 42, 0.6)",color:"#e2e8f0",fontSize:"0.62rem",letterSpacing:"0.12em",textTransform:"uppercase",padding:"0.32rem 0.9rem",cursor:"pointer",transition:"background 0.2s ease, border-color 0.2s ease"},wa={borderColor:"rgba(56, 189, 248, 0.6)",background:"rgba(37, 99, 235, 0.18)",color:"#e0f2fe",filter:"drop-shadow(0 0 10px rgba(56, 189, 248, 0.4))"},Ma={flex:1,minHeight:0,display:"flex",height:"100%"},ye={flex:1,minHeight:0,display:"flex",flexDirection:"column",height:"100%"},Ia={...J,display:"flex",flexDirection:"column",padding:"0.6rem",minHeight:0,flex:1,position:"relative",zIndex:0,overflow:"hidden"},Wt={borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:"rgba(15, 23, 42, 0.6)",color:"#e2e8f0",fontSize:"0.6rem",letterSpacing:"0.14em",textTransform:"uppercase",padding:"0.3rem 0.75rem",cursor:"pointer",transition:"background 0.2s ease, border-color 0.2s ease"},zt={borderColor:"rgba(56, 189, 248, 0.6)",background:"rgba(37, 99, 235, 0.2)",color:"#e0f2fe"},Pt={borderColor:"rgba(248, 113, 113, 0.55)",color:"#fecaca"},Ta={...J,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.72rem",color:"rgba(148, 163, 184, 0.8)"},Ra=({open:r,onClose:n})=>{const u=L(o=>o.settings.locale),m=L(o=>!!o.settings.reputationSystemsEnabled),l=Z(u),v=s.useRef(null),[g,k]=s.useState("inventory"),[c,A]=s.useState(!0),[j,P]=s.useState(!0),B=s.useMemo(()=>({...xa,gridTemplateColumns:c&&j?Lt:"1fr"}),[c,j]),R=s.useCallback(o=>{o.key==="Escape"&&(o.preventDefault(),o.stopPropagation(),n())},[n]);s.useEffect(()=>{if(r)return v.current&&v.current.focus(),document.addEventListener("keydown",R),()=>document.removeEventListener("keydown",R)},[r,R]),s.useEffect(()=>{r&&(A(!0),P(!0))},[r]),s.useEffect(()=>{!m&&g==="reputation"&&k("inventory")},[g,m]);const E=[{id:"inventory",label:l.character.tabs.inventory},{id:"loadout",label:l.character.tabs.loadout},{id:"skills",label:l.character.tabs.skills},{id:"reputation",label:l.character.tabs.reputation}],h=m?E:E.filter(o=>o.id!=="reputation");if(!r)return null;const D=o=>{o.target===o.currentTarget&&n()};return e.jsx("div",{style:pa,role:"dialog","aria-modal":"true","aria-labelledby":"character-screen-title","data-testid":"character-screen",onClick:D,children:e.jsxs("div",{style:ua,children:[e.jsx(Kn,{color:"#38bdf8",size:24,thickness:2}),e.jsx(It,{opacity:.05}),e.jsxs("header",{style:ma,children:[e.jsxs("div",{style:ya,children:[e.jsx("span",{style:ga,id:"character-screen-title",children:l.shell.characterTitle}),e.jsx("span",{style:fa,children:l.shell.characterSubtitle})]}),e.jsxs("div",{style:ba,children:[e.jsx("button",{type:"button",style:{...Wt,...c?zt:Pt},"aria-pressed":c,onClick:()=>A(o=>!o),children:l.character.profileToggle}),e.jsx("button",{type:"button",style:{...Wt,...j?zt:Pt},"aria-pressed":j,onClick:()=>P(o=>!o),children:l.character.systemsToggle}),e.jsx("button",{type:"button",onClick:n,style:ha,"data-testid":"close-character",ref:v,children:l.character.closeLabel})]})]}),e.jsxs("div",{style:B,children:[c&&e.jsxs("div",{style:Sa,children:[e.jsx(ar,{showActionButton:!1}),e.jsx(Rr,{})]}),j&&e.jsx("div",{style:ja,children:e.jsxs("div",{style:va,children:[e.jsx("div",{style:ka,role:"tablist","aria-label":l.character.tablistAria,children:h.map(o=>{const f=g===o.id;return e.jsx("button",{type:"button",role:"tab","aria-selected":f,"aria-controls":`character-tab-${o.id}`,id:`character-tab-trigger-${o.id}`,onClick:()=>k(o.id),style:{...Ca,...f?wa:{}},children:o.label},o.id)})}),e.jsxs("div",{style:Ma,children:[g==="inventory"&&e.jsx("div",{id:"character-tab-inventory",role:"tabpanel","aria-labelledby":"character-tab-trigger-inventory",style:ye,children:e.jsx(Gn,{})}),g==="loadout"&&e.jsx("div",{id:"character-tab-loadout",role:"tabpanel","aria-labelledby":"character-tab-trigger-loadout",style:ye,children:e.jsx(bn,{})}),g==="skills"&&e.jsx("div",{id:"character-tab-skills",role:"tabpanel","aria-labelledby":"character-tab-trigger-skills",style:ye,children:e.jsxs("div",{style:Ia,children:[e.jsx(It,{opacity:.04}),e.jsx(Qr,{})]})}),m&&g==="reputation"&&e.jsx("div",{id:"character-tab-reputation",role:"tabpanel","aria-labelledby":"character-tab-trigger-reputation",style:ye,children:e.jsx(da,{})})]})]})}),!c&&!j&&e.jsx("div",{style:{...Ta,gridColumn:"1 / -1"},children:l.character.hiddenState})]})]})})};export{Ra as default};
