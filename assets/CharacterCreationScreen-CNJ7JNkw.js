import{r as l,j as e}from"./vendor-Cc93p67d.js";import{aS as Q,bo as X}from"./game-core-rSlhvLSb.js";import{q as ee}from"./game-content-CQeS209Q.js";import{E as m}from"./EnhancedButton-DVdhyrz_.js";import{N as te,T as re,a as ne}from"./Tooltip-CnX58fCC.js";import{g as ie}from"./index-tSNbu67R.js";import"./phaser-DkaA9Y8j.js";const w=[{id:"operative",label:"Operative",description:"Tactical specialist"},{id:"survivor",label:"Survivor",description:"Street-hardened fighter"},{id:"tech",label:"Tech",description:"Underground hacker"},{id:"scavenger",label:"Scavenger",description:"Wasteland wanderer"}],V=["Raven","Ghost","Cipher","Echo","Viper","Phoenix","Shadow","Blade","Nova","Wraith","Spark","Drift"],se=n=>n.type==="catalog"?ee(n.definitionId).name:n.name,C={strength:{label:"STR",description:"Melee damage, carry weight"},perception:{label:"PER",description:"Hit chance, critical chance, awareness"},endurance:{label:"END",description:"Max health points"},charisma:{label:"CHA",description:"Dialogue options, persuasion"},intelligence:{label:"INT",description:"Skill points per level, hacking"},agility:{label:"AGI",description:"Action points, dodge chance"},luck:{label:"LCK",description:"Critical chance, random events"}},oe=["strength","perception","endurance","charisma","intelligence","agility","luck"],ae={position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(15, 23, 42, 0.98)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999,fontFamily:"'DM Sans', 'Inter', sans-serif"},le={background:"linear-gradient(135deg, rgba(30, 41, 59, 0.95), rgba(15, 23, 42, 0.95))",border:"2px solid rgba(56, 189, 248, 0.3)",borderRadius:"16px",padding:"1.5rem",maxWidth:"600px",width:"90%",maxHeight:"95vh",boxShadow:"0 25px 50px rgba(0, 0, 0, 0.5), 0 0 100px rgba(56, 189, 248, 0.1)",overflowY:"auto",display:"flex",flexDirection:"column"},ce={fontSize:"1.3rem",fontWeight:700,marginBottom:"0.3rem",textTransform:"uppercase",letterSpacing:"0.1em",...ie("#bfdbfe","#38bdf8"),filter:"drop-shadow(0 0 20px rgba(56, 189, 248, 0.5))"},de={fontSize:"0.8rem",color:"#94a3b8",marginBottom:"1rem",letterSpacing:"0.05em"},me={display:"flex",gap:"0.5rem",marginBottom:"1rem",justifyContent:"center"},A=n=>({width:"12px",height:"12px",borderRadius:"50%",backgroundColor:n?"#38bdf8":"rgba(148, 163, 184, 0.3)",boxShadow:n?"0 0 10px rgba(56, 189, 248, 0.6)":"none",transition:"all 0.3s ease"}),k={fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.1em",color:"#94a3b8",marginBottom:"0.4rem",fontWeight:600},pe={width:"100%",padding:"0.65rem 1rem",backgroundColor:"rgba(15, 23, 42, 0.8)",border:"1px solid rgba(148, 163, 184, 0.3)",borderRadius:"8px",color:"#e2e8f0",fontSize:"0.95rem",fontFamily:"'DM Mono', monospace",marginBottom:"1rem",outline:"none",transition:"border-color 0.2s ease"},ge={display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"0.8rem",marginBottom:"1rem"},he=n=>({padding:"0.75rem",backgroundColor:n?"rgba(56, 189, 248, 0.15)":"rgba(30, 41, 59, 0.6)",border:`2px solid ${n?"#38bdf8":"rgba(148, 163, 184, 0.2)"}`,borderRadius:"8px",cursor:"pointer",transition:"all 0.2s ease",textAlign:"center",boxShadow:n?"0 0 20px rgba(56, 189, 248, 0.3)":"none"}),ue={fontSize:"0.9rem",fontWeight:600,color:"#e2e8f0",marginBottom:"0.2rem"},xe={fontSize:"0.7rem",color:"#94a3b8"},E={display:"flex",gap:"0.75rem",marginTop:"0.75rem"},I={color:"#ef4444",fontSize:"0.75rem",marginTop:"-1rem",marginBottom:"1rem"},ye={display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.4rem 0.6rem",backgroundColor:"rgba(30, 41, 59, 0.6)",border:"1px solid rgba(148, 163, 184, 0.2)",borderRadius:"6px",marginBottom:"0.4rem"},fe={flex:1},be={fontSize:"0.8rem",fontWeight:600,color:"#e2e8f0",letterSpacing:"0.05em"},Se={fontSize:"0.65rem",color:"#94a3b8",marginTop:"0.15rem"},je={display:"flex",alignItems:"center",gap:"0.6rem"},G=n=>({width:"28px",height:"28px",borderRadius:"6px",backgroundColor:n?"rgba(148, 163, 184, 0.1)":"rgba(56, 189, 248, 0.2)",border:`1px solid ${n?"rgba(148, 163, 184, 0.2)":"rgba(56, 189, 248, 0.4)"}`,color:n?"#64748b":"#38bdf8",fontSize:"1rem",fontWeight:700,cursor:n?"not-allowed":"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",outline:"none"}),ve={fontSize:"1.25rem",fontWeight:700,color:"#38bdf8",minWidth:"30px",textAlign:"center",fontFamily:"'DM Mono', monospace"},Ce={textAlign:"center",padding:"0.6rem",backgroundColor:"rgba(56, 189, 248, 0.1)",border:"1px solid rgba(56, 189, 248, 0.3)",borderRadius:"6px",marginBottom:"0.8rem"},ke={fontSize:"0.65rem",color:"#94a3b8",textTransform:"uppercase",letterSpacing:"0.1em",marginTop:"0.2rem"},ze={display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"0.4rem",marginBottom:"0.8rem"},p={padding:"0.4rem 0.5rem",backgroundColor:"rgba(30, 41, 59, 0.6)",border:"1px solid rgba(148, 163, 184, 0.2)",borderRadius:"6px"},g={fontSize:"0.7rem",color:"#94a3b8",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.25rem"},h={fontSize:"1.1rem",fontWeight:700,color:"#38bdf8",fontFamily:"'DM Mono', monospace"},Ie=({onComplete:n,onCancel:K})=>{const[s,f]=l.useState(1),[b,M]=l.useState(""),[S,z]=l.useState(""),[B,u]=l.useState(""),x=l.useRef(null),[o,O]=l.useState({strength:5,perception:5,endurance:5,charisma:5,intelligence:5,agility:5,luck:5}),[c,U]=l.useState(5),[T,P]=l.useState(""),[y,N]=l.useState(""),[$,j]=l.useState("");l.useLayoutEffect(()=>{var t;s===1&&((t=x.current)==null||t.focus())},[s]);const W=t=>t.length<3?(u("Name must be at least 3 characters"),!1):t.length>20?(u("Name must be at most 20 characters"),!1):/^[a-zA-Z0-9\s-]+$/.test(t)?(u(""),!0):(u("Name can only contain letters, numbers, spaces, and hyphens"),!1),_=t=>{const r=t.target.value;M(r),r.length>0?W(r):u("")},q=()=>{const t=V[Math.floor(Math.random()*V.length)],r=w[Math.floor(Math.random()*w.length)].id;M(t),z(r),u("")},L=(t,r)=>{const a=o[t]+r;a<1||a>10||r>0&&c<=0||(O({...o,[t]:a}),U(D=>D-r),T&&P(""))},H=()=>{W(b)&&S&&f(2)},Y=()=>{f(1)},Z=()=>{if(c>0){P("Spend all remaining attribute points before proceeding.");return}j(""),f(3)},R=b.length>=3&&S&&!B,F=c===0,d=Q(o),J=(t,r)=>{switch(t){case"strength":return[`Carry capacity ${25+r*5} kg`,`Melee bonus +${Math.floor(r/2)}`];case"perception":return[`Hit bonus ${(r-5)*3}%`];case"endurance":return[`Max HP ${50+r*10}`];case"charisma":return[`Dialogue bonus +${Math.floor(r/2)}`];case"intelligence":return[`Skill points per level ${3+Math.floor(r/3)}`];case"agility":return[`Base AP ${6+Math.floor((r-5)*.5)}`,`Dodge bonus ${(r-5)*2}%`];case"luck":return[`Luck boosts crits (+${r*2}%) and random events`];default:return[]}},v=[];return o.endurance<=2&&v.push("Endurance below 3 â€“ expect severely reduced health."),o.agility<=2&&v.push("Agility below 3 limits action points and evasion."),e.jsx("div",{style:ae,children:e.jsxs("div",{style:le,children:[e.jsx("h1",{style:ce,children:"Character Creation"}),e.jsxs("p",{style:de,children:[s===1&&"Define your operative's identity",s===2&&"Allocate your attributes",s===3&&"Choose your background"]}),e.jsxs("div",{style:me,children:[e.jsx("div",{style:A(s===1)}),e.jsx("div",{style:A(s===2)}),e.jsx("div",{style:A(s===3)})]}),s===1&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{style:k,children:"Call Sign"}),e.jsx("input",{ref:x,type:"text",value:b,onChange:_,placeholder:"Enter your operative name...",style:pe,maxLength:20,autoFocus:!0,onMouseDown:t=>{x.current&&x.current.focus(),t.stopPropagation()},onKeyDown:t=>{t.key==="Enter"&&R&&H()},onBlur:()=>{s===1&&requestAnimationFrame(()=>{var t;return(t=x.current)==null?void 0:t.focus()})}}),B&&e.jsx("div",{style:I,children:B})]}),e.jsxs("div",{children:[e.jsx("label",{style:k,children:"Visual Profile"}),e.jsx("div",{style:ge,children:w.map(t=>e.jsxs("div",{style:he(S===t.id),onClick:()=>z(t.id),onKeyDown:r=>{(r.key==="Enter"||r.key===" ")&&(r.preventDefault(),z(t.id))},role:"button",tabIndex:0,children:[e.jsx("div",{style:ue,children:t.label}),e.jsx("div",{style:xe,children:t.description})]},t.id))})]}),e.jsxs("div",{style:E,children:[e.jsx(m,{onClick:K,variant:"secondary",size:"medium",children:"Cancel"}),e.jsx(m,{onClick:q,variant:"secondary",size:"medium",icon:"ðŸŽ²",children:"Randomize"}),e.jsx(m,{onClick:H,variant:"primary",size:"medium",disabled:!R,title:R?"Continue to next step":"Complete all fields to proceed",children:"Continue"})]}),!1]}),s===2&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{...Ce,display:"flex",alignItems:"center",justifyContent:"center",gap:"0.6rem"},children:[e.jsx(te,{count:c,color:"#38bdf8",size:28,pulse:c>0}),e.jsx("div",{style:ke,children:"Points Remaining"})]}),e.jsxs("div",{children:[e.jsx("label",{style:k,children:"SPECIAL Attributes"}),oe.map(t=>{const r=o[t],i=J(t,r),a=[`Rank ${r}`,"SPECIAL attribute"];return e.jsx(re,{content:e.jsx(ne,{title:C[t].label,description:C[t].description,lines:i,meta:a}),wrapperStyle:{display:"block"},children:e.jsxs("div",{style:ye,children:[e.jsxs("div",{style:fe,children:[e.jsx("div",{style:be,children:C[t].label}),e.jsx("div",{style:Se,children:C[t].description})]}),e.jsxs("div",{style:je,children:[e.jsx("button",{onClick:()=>L(t,-1),disabled:o[t]<=1,style:G(o[t]<=1),title:"Decrease attribute",children:"âˆ’"}),e.jsx("div",{style:ve,children:o[t]}),e.jsx("button",{onClick:()=>L(t,1),disabled:o[t]>=10||c<=0,style:G(o[t]>=10||c<=0),title:"Increase attribute",children:"+"})]})]})},t)})]}),T&&e.jsx("div",{style:{...I,marginTop:"0.5rem"},children:T}),v.length>0&&e.jsx("div",{style:{backgroundColor:"rgba(248, 113, 113, 0.1)",border:"1px solid rgba(248, 113, 113, 0.4)",borderRadius:"8px",padding:"0.65rem",color:"#f87171",fontSize:"0.75rem",marginBottom:"1rem"},children:v.map(t=>e.jsx("div",{children:t},t))}),e.jsxs("div",{children:[e.jsx("label",{style:k,children:"Derived Stats"}),e.jsxs("div",{style:ze,children:[e.jsxs("div",{style:p,children:[e.jsx("div",{style:g,children:"Max HP"}),e.jsx("div",{style:h,children:d.maxHP})]}),e.jsxs("div",{style:p,children:[e.jsx("div",{style:g,children:"Max Stamina"}),e.jsx("div",{style:h,children:d.maxStamina})]}),e.jsxs("div",{style:p,children:[e.jsx("div",{style:g,children:"Base AP"}),e.jsx("div",{style:h,children:d.baseAP})]}),e.jsxs("div",{style:p,children:[e.jsx("div",{style:g,children:"Carry Weight"}),e.jsxs("div",{style:h,children:[d.carryWeight," kg"]})]}),e.jsxs("div",{style:p,children:[e.jsx("div",{style:g,children:"Crit Chance"}),e.jsxs("div",{style:h,children:[d.criticalChance,"%"]})]}),e.jsxs("div",{style:p,children:[e.jsx("div",{style:g,children:"Hit Bonus"}),e.jsxs("div",{style:h,children:[d.hitChanceModifier,"%"]})]}),e.jsxs("div",{style:p,children:[e.jsx("div",{style:g,children:"Dodge Bonus"}),e.jsxs("div",{style:h,children:[d.dodgeChance,"%"]})]})]})]}),e.jsxs("div",{style:E,children:[e.jsx(m,{onClick:Y,variant:"secondary",size:"medium",children:"Back"}),e.jsx(m,{onClick:Z,variant:"primary",size:"medium",disabled:!F,title:F?"Continue to next step":"Spend all points to proceed",children:"Continue"})]})]}),s===3&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"0.75rem",marginBottom:"1rem"},children:X.map(t=>{const r=y===t.id;return e.jsxs("div",{style:{padding:"0.75rem",borderRadius:"8px",border:r?"2px solid #38bdf8":"1px solid rgba(148, 163, 184, 0.25)",background:r?"rgba(56, 189, 248, 0.12)":"rgba(15, 23, 42, 0.6)",boxShadow:r?"0 0 25px rgba(56, 189, 248, 0.25)":"none",cursor:"pointer",display:"flex",flexDirection:"column",gap:"0.5rem"},onClick:()=>{N(t.id),j("")},role:"button",tabIndex:0,"data-testid":`background-card-${t.id}`,"aria-label":`${t.name} background`,onKeyDown:i=>{(i.key==="Enter"||i.key===" ")&&(i.preventDefault(),N(t.id),j(""))},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[e.jsx("span",{style:{fontSize:"0.6rem",color:"#94a3b8",letterSpacing:"0.14em",textTransform:"uppercase"},children:t.tagline}),e.jsx("h3",{style:{fontSize:"0.95rem",fontWeight:600,color:"#e2e8f0",margin:0},children:t.name}),t.description.map(i=>e.jsx("p",{style:{fontSize:"0.68rem",color:"#94a3b8",margin:0,lineHeight:1.3},children:i},i))]}),t.perk&&e.jsxs("div",{children:[e.jsx("span",{style:{fontSize:"0.6rem",color:"#22d3ee",letterSpacing:"0.12em",textTransform:"uppercase"},children:"Starting Perk"}),e.jsx("div",{style:{fontSize:"0.75rem",fontWeight:600,color:"#38bdf8"},children:t.perk.name}),e.jsx("p",{style:{fontSize:"0.65rem",color:"#94a3b8",margin:"0.15rem 0 0",lineHeight:1.3},children:t.perk.description})]}),e.jsxs("div",{children:[e.jsx("span",{style:{fontSize:"0.6rem",color:"#f472b6",letterSpacing:"0.12em",textTransform:"uppercase"},children:"Faction Standing"}),e.jsx("ul",{style:{margin:"0.2rem 0 0",paddingLeft:"1rem",color:"#cbd5e1",fontSize:"0.65rem",lineHeight:1.4},children:["resistance","corpsec","scavengers"].map(i=>{const a=t.factionAdjustments[i]??0,D=i==="corpsec"?"CorpSec":i==="scavengers"?"Scavengers":"Resistance";return e.jsxs("li",{children:[D,": ",a>=0?"+":"",a]},`${t.id}-${i}`)})})]}),e.jsxs("div",{children:[e.jsx("span",{style:{fontSize:"0.6rem",color:"#a855f7",letterSpacing:"0.12em",textTransform:"uppercase"},children:"Starting Gear"}),e.jsx("ul",{style:{margin:"0.2rem 0 0",paddingLeft:"1rem",color:"#cbd5e1",fontSize:"0.65rem",lineHeight:1.4},children:t.startingEquipment.map(i=>{const a=se(i);return e.jsx("li",{children:a},`${t.id}-${a}`)})})]})]},t.id)})}),$&&e.jsx("div",{style:{...I,marginTop:0},children:$}),e.jsxs("div",{style:E,children:[e.jsx(m,{onClick:()=>f(2),variant:"secondary",size:"medium",children:"Back"}),e.jsx(m,{onClick:()=>{if(!y){j("Select a background to proceed.");return}n({name:b,visualPreset:S,attributes:o,backgroundId:y})},variant:"success",size:"medium",disabled:!y,title:y?"Begin mission":"Select a background to confirm",icon:"â–¶",children:"Confirm & Start"})]})]})]})})};export{Ie as default};
